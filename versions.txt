/*****************************************************************************/
/*                                                                           */
/* Version history:                                                          */
/*                                                                           */
/* Serpent 2.0.X - In-house version, very limited distribution outside VTT   */
/*                 for development purposes only                             */
/*                                                                           */
/* Serpent 2.1.X - Beta version distributed to existing users. For testing   */
/*                 and validation before final public distribution.          */
/*                                                                           */
/* Serpent 2.2.X - Publicly distributed version                              */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.0  (2010/09/10) :                                             */
/*                                                                           */
/* - Beginning of project. Development starts with processing routines       */
/*   handling neutron interaction, decay and fission yield data. Some        */
/*   subroutines are new, some adapted from Serpent 1.1.X                    */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.1  (2010/09/14) :                                             */
/*                                                                           */
/* - Code reads and handles basic nuclide data and constructs decay and      */
/*   transmutation chains. Fission product yield, energy threshold and       */
/*   stabililty cut-offs included.                                           */
/*                                                                           */
/* - Dosimetry and thermal scattering data is not yet handled. Spontaneous   */
/*   fission yields are not read, but the processing routines are in place.  */
/*                                                                           */
/* - Way too many transport nuclides (~300) are included in the calculation, */
/*   even whith cut-offs.                                                    */
/*                                                                           */
/* - Various checks are performed and output printed is in file.             */
/*                                                                           */
/* - AddBranching() sotkee fissio yieldien järjestyksen. Jokaisesta yield-   */
/*   blokista on pointteri seuraavaan, eli niiden läpi pystyy luuppaamaan.   */
/*   --> bugivaara.                                                          */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.2  (2010/09/20) :                                             */
/*                                                                           */
/* - List structures and handling functions added. Some testing done.        */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.3  (2010/09/22) :                                             */
/*                                                                           */
/* - Previous nuclide routines converted to use the new structures and       */
/*   functions. Results OK compared to version 2.0.1.                        */
/*                                                                           */
/* - Use of aliases may produce duplicate nuclides --> use a single name     */
/*   read from the directory file?                                           */
/*                                                                           */
/* - No id and temperature for decay-type nuclides --> not connected in      */
/*   decay / transmutation chains of transport nuclides?                     */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.4  (2010/09/27) :                                             */
/*                                                                           */
/* - Major changes in routines, thermal scattering data read, spontaneous    */
/*   fission yields read.                                                    */
/*                                                                           */
/* - Handling of temperatures / libray ID's should work (also with Doppler   */
/*   broadening).                                                            */
/*                                                                           */
/* - Thermal scattering and dosimetry data still not processed.              */
/*                                                                           */
/* - Decay nuclides cannot be used in material definitions.                  */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.5  (2010/10/07) :                                             */
/*                                                                           */
/* - Some geometry routines added                                            */
/*                                                                           */
/* - Geometry plotter works with nests and surface transformations but most  */
/*   of the functionality is still missing.                                  */
/*                                                                           */
/* - Surface distances are not calculated                                    */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.6  (2010/10/10) :                                             */
/*                                                                           */
/* - More geometry routines added                                            */
/*                                                                           */
/* - Calculation of surface distances added                                  */
/*                                                                           */
/* - Geometry plotter more or less completed                                 */
/*                                                                           */
/* - Universe definition with cells and surfaces still missing               */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.7  (2010/10/18) :                                             */
/*                                                                           */
/* - Universe definition with cells and surfaces added                       */
/*                                                                           */
/* - Unions seem to work OK, but not thoroughly tested                       */
/*                                                                           */
/* - Some lattice types still missing                                        */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.8  (2010/10/22) :                                             */
/*                                                                           */
/* - Remaining lattice types added, particle fuel geometry still missing     */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.9  (2010/10/25) :                                             */
/*                                                                           */
/* - Particle fuel geometry added, the initialization routines work very     */
/*   slow in debug mode                                                      */
/*                                                                           */
/* - Versions 2.0.5 to 2.0.9 were developed in OSX, without memory checking  */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.10  (2010/11/09) :                                            */
/*                                                                           */
/* - Threading with OpenMP implemented in geometry plotter routine           */
/*                                                                           */
/* - Memory checker run and some problems fixed. OpenMP routines result in   */
/*   a possible leak (not free'd), but this may also be a bug in valgrind.   */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.11  (2010/11/14) :                                            */
/*                                                                           */
/* - Volume calculation routine implemented (materials only). Works with     */
/*   threading.                                                              */
/*                                                                           */
/* - Some bugs fixed in geometry routines.                                   */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.12  (2010/11/23) :                                            */
/*                                                                           */
/* - Data structures and list functions rewritten, otherwise the same        */
/*   functionality as in the first version of 2.0.11. No more POINTER array, */
/*   everything is done in DATA. Some speed-up (~10%) in calculations.       */
/*                                                                           */
/* - Some considerable cleanup done.                                         */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.13  (2010/12/12) :                                            */
/*                                                                           */
/* - Data structure for energy grids, subroutines for grid generation and    */
/*   search. Some testing done.                                              */
/*                                                                           */
/* - Alternate non-recursive geometry routine in WhereAmI().                 */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.14  (2010/12/27) :                                            */
/*                                                                           */
/* - Cross sections processed with or without unionized grid.                */
/*                                                                           */
/* - Plotter routine for microscopic cross sections.                         */
/*                                                                           */
/* - Tester routine for constructing arbitrary combinations of nuclides      */
/*   and options.                                                            */
/*                                                                           */
/* - Data includes only microscopic reaction and special cross sections,     */
/*   no totals or material-wise macroscopic data.                            */
/*                                                                           */
/* - S(a,b) data read and processed but not linked to nuclides.              */
/*                                                                           */
/* - Nothing is done for dosimetry data.                                     */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.15  (2011/01/04) :                                            */
/*                                                                           */
/* - Processing, cross section, plotter and tester routines for material-    */
/*   wise macroscopic cross sections.                                        */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.16  (2011/01/06) :                                            */
/*                                                                           */
/* - Reaction sampling added in tester routine and several bugs fixed.       */
/*                                                                           */
/* - Parallelization with OpenMP.                                            */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.17  (2011/01/08) :                                            */
/*                                                                           */
/* - Majorant cross section calculated for delta-tracking (DBRC routine      */
/*   still missing).                                                         */
/*                                                                           */
/* - a Few more bug fixes.                                                   */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.18 (2011/01/12):                                              */
/*                                                                           */
/* - Some major troubleshooting done (NOTE TO SELF: direct pointers to       */
/*   arrays may cause segmentation fault if ReallocMem() is called!!!)       */
/*                                                                           */
/* - Tester routine works pretty well with different optimization modes and  */
/*   ures data. Majorants are calculated but not tested.                     */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.19 (2011/01/13):                                              */
/*                                                                           */
/* - Majorant testing added (adjustment mode)                                */
/*                                                                           */
/* - Some improvements in OpenMP routines, but performance still not very    */
/*   good (about factor 3 speedup using 8 cores)                             */
/*                                                                           */
/* - Potential problems: - Compiler? (now using gcc 4.1.2, previous tests    */
/*                         have shown strange behavior, including best       */
/*                         performance with -O0)                             */
/*                                                                           */
/*                       - rand48() function sets blocks that cause other    */
/*                         threads to wait? This shouldn't be a problem      */
/*                         because random number generator must be changed   */
/*                         anyway.                                           */
/*                                                                           */
/*                       - Parallel for-loops with schedule(dynamic) have    */
/*                         some impact                                       */
/*                                                                           */
/*                       - Calls to omp_get_thread_num() in TestValuePair()  */
/*                         and StoreValuePair() seem to have no impact on    */
/*                         performance                                       */
/*                                                                           */
/*                       - Memory bandwidth may be a problem? Try to reduce  */
/*                         access to DATA array and pass values as function  */
/*                         arguments instead?                                */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.20 (2011/01/19):                                              */
/*                                                                           */
/* - A few test routines added. Still no solution to the OpenMP performance  */
/*   issue.                                                                  */
/*                                                                           */
/* - Stable version before adding any reaction physics.                      */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.21 (2011/01/20):                                              */
/*                                                                           */
/* - Angular distributions read, processed and sampled                       */
/*                                                                           */
/* - Potential bug: mt 1002 sampled even though energy is above upper limit  */
/*   DATA[rea + REACTION_EMAX]                                               */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.22 (2011/01/22):                                              */
/*                                                                           */
/* - Material mixtures included                                              */
/*                                                                           */
/* - Some bug fixes                                                          */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.23 (2011/01/24):                                              */
/*                                                                           */
/* - S(a,b) data added directly in reaction channels (works also with        */
/*   temperature interpolation                                               */
/*                                                                           */
/* - Bug fixes and tests                                                     */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.24 (2011/01/31):                                              */
/*                                                                           */
/* - Burnup matrixes generated                                               */
/*                                                                           */
/* - A lot of bug fixes and cleanup for depletion chains, S(a,b) data, etc.  */
/*                                                                           */
/* - Isomeric branching ratios for transmutation reactions read in energy-   */
/*   dependent format.                                                       */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.25 (2011/02/28):                                              */
/*                                                                           */
/* - Compatibility tested with intel compiler (minor improvement in OpenMP   */
/*   scalability)                                                            */
/*                                                                           */
/* - Energy distributions included                                           */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.26 (2011/03/02):                                              */
/*                                                                           */
/* - Routines for scattering included                                        */
/*                                                                           */
/* - Tester routine for transport in infinite geometry, pretty good results  */
/*   compared to Serpent 1.1.14                                              */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.27 (2011/03/09):                                              */
/*                                                                           */
/* - Some source and detector routines added                                 */
/*                                                                           */
/* - Implicit capture added                                                  */
/*                                                                           */
/* - Fission routines added                                                  */
/*                                                                           */
/* - Comparisons to MCNP5 show good agreement in 5 test cases, some results  */
/*   are better than Serpent 1.1.14 (JEF-2.2 U238 @ high E), some show small */
/*   for both Serpents (JEF-2-2 thermal U238, hydrogen mix @ thermal E).     */
/*                                                                           */
/*   EDIT: Tuo johtui siitä että viivästyneitä neutroneita ei sämplätty      */
/*         ollenkaan. Kun rutiini korjattiin, tulokset menivät samalla       */
/*         tavalla pieleen kuin Serpentissä.                                 */
/*                                                                           */
/* - Jotain häröä noissa tuloksissa vielä on, ja spektrit eivät ole ihan     */
/*   samoja kaikilla optiolla. Ptable treatmentissä saattaa myös olla jotain */
/*   pientä ongelmaa (puhdas U-238 19 MeV neutronilähde on hyvä testitapaus) */
/*                                                                           */
/*   EDIT2: Koko häikkä johtui siitä että MCNP:ssä on viivästyneiden         */
/*          neutronien emissio lähdemoodissa defaulttina pois.               */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.28 (2011/03/16):                                              */
/*                                                                           */
/* - Tracking routine added and some bugs corrected in geometry routines     */
/*                                                                           */
/* - Keff calculation and runtime estimates added                            */
/*                                                                           */
/* - Good results in standard validation cases                               */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.29: (2011/03/30):                                             */
/*                                                                           */
/* - Neutron history data stored in array for adjoint calculation. Some      */
/*   limited testing done.                                                   */
/*                                                                           */
/* - Mesh plotter routine implemented.                                       */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.30: (2011/04/15):                                             */
/*                                                                           */
/* - Parallelization of transport routine using OpenMP, works in both fixed  */
/*   and criticality source modes.                                           */
/*                                                                           */
/* - New history-based RNG that preserves the results of serial calculation  */
/*   in parallel mode.                                                       */
/*                                                                           */
/* - Radiation spectra read from ENDF decay data file.                       */
/*                                                                           */
/* - First methods for gamma transport simulation: coherent Thompson         */
/*   scattering, incoherent Compton scattering with Klein-Nishina formula    */
/*   without form factors, photoelectric effect treated as capture, simple   */
/*   pair production model. No TTB. Results not validated, doesn't work in   */
/*   OpenMP mode, even though the routines are more or less the same as in   */
/*   external source neutron transport simulation.                           */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.31: (2011/05/02):                                             */
/*                                                                           */
/* - Bugs in OMP mode gamma transport fixed.                                 */
/*                                                                           */
/* - Doppler Broadening Rejection Correction (DBRC) method implemented.      */
/*                                                                           */
/* - Bug identified: total exceeds majorant (optimization modes 0 and 1 with */
/*   high reconstruction tolerance for grid thinning)                        */
/*                                                                           */
/* - Bug identified: global energy boundaries are not properly defined,      */
/*   which causes problems and an infinite tracking loop (majorant and total */
/*   become zero)                                                            */
/*                                                                           */
/* - Calculation of transmutation coefficients and fission yields started    */
/*   (group structure still defined manually)                                */
/*                                                                           */
/* - Some group constant generation (no universe-binning)                    */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.32: (2011/05/18):                                             */
/*                                                                           */
/* - Detector cells, materials and universes added.                          */
/*                                                                           */
/* - Universe binning added in group constant generation                     */
/*                                                                           */
/* - CFE in void regions enabled                                             */
/*                                                                           */
/* - Bug fix in targetvelocity.c                                             */
/*                                                                           */
/* - Scattering parameters scored                                            */
/*                                                                           */
/* - Atomic pragmas in addbuf.c form a bottle neck in OpenMP mode? ->        */
/*   alternative solution based on binning by thread index instead           */
/*                                                                           */
/* - Bug identified and corrected: OMP related initialization before number  */
/*   of threads was set                                                      */
/*                                                                           */
/* - Some tests with source biasing for variance reduction in full-core      */
/*   problems                                                                */
/*                                                                           */
/* - History data for statistics                                             */
/*                                                                           */
/* - Fission source and collision distribution entropies calculated          */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.33: (2011/06/06):                                             */
/*                                                                           */
/* - CRAM solver for depletion equations added in a simple burnup loop.      */
/*   The routine contains one or several bugs that result in non-physical    */
/*   results or infinite loop in some calculation cases. The problem is most */
/*   likely in subroutine symboliclu.c                                       */
/*                                                                           */
/* - Code cleanup done, the names of some subroutine were changed            */
/*                                                                           */
/* - Material compositions in burnup calculation stored in binary files      */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.34 (2011/06/15):                                              */
/*                                                                           */
/* - Problems in CRAM solver fixed                                           */
/*                                                                           */
/* - Calculation of scattering production cross sections changed to          */
/*   similar to Serpent 1.1.15                                               */
/*                                                                           */
/* - Group constants moved to gcu structures to avoid universe binning in    */
/*   stat functions                                                          */
/*                                                                           */
/* - Definition of NXNXS and IMP_KEFF changed to account for all (n,xn)      */
/*   multiplication                                                          */
/*                                                                           */
/* - TTA solver added, first test calculations give consistent results with  */
/*   CRAM, but both differ from Serpent 1.1.15, especially for fission       */
/*   product isotopes                                                        */
/*                                                                           */
/* - Development of advanced predictor-corrector methods started             */
/*                                                                           */
/* - Infinite lattice calculations give good results for GC generation when  */
/*   compared to MCNP5, but also show that unresolved resonance probability  */
/*   table treatment doesn't work                                            */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.35 (2011/07/04):                                              */
/*                                                                           */
/* - Treatment of material-wise reaction lists and macroscopic xs divided    */
/*   into multiple subroutines to simplify data management with MPI          */
/*                                                                           */
/* - Automated volume calculation for nests                                  */
/*                                                                           */
/* - Burnable materials divided into sub-regions similar to Serpent 1        */
/*                                                                           */
/* - Problem identified: Nuclides in inventory lists are not included, whic  */
/*   may cause unnecessary termination if transmutation chains do not extend */
/*   far enough                                                              */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.36 (2011/07/19):                                              */
/*                                                                           */
/* - Advanced predictor-corrector methods implemented                        */
/*                                                                           */
/* - Detector routines changed and new features added for mesh plotting      */
/*                                                                           */
/* - Bug in fission yield distributions fixed                                */
/*                                                                           */
/* - Optimization modes redefined, burnup calculation should now work in all */
/*   modes                                                                   */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.37 (2011/09/06):                                              */
/*                                                                           */
/* - Doppler-broadening preprocesser routine added                           */
/*                                                                           */
/* - Problems in reaction physics fixed in Super and Serpent 1.1.16.         */
/*                                                                           */
/* - Problem identified: Negative cross sections are handled different from  */
/*   MCNP (set to zero and summed to total), which may cause major           */
/*   differences in the results. The same problem concerns Serpent 1.        */
/*                                                                           */
/* - CRAM fixed                                                              */
/*                                                                           */
/* - OpenMP routines in burnup mode. Works reasonably well, performace still */
/*   poor                                                                    */
/*                                                                           */
/* - Doppler-broadening preprocessor may have a bug?                         */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.38 (2011/11/10):                                              */
/*                                                                           */
/* - Lattice detectors added and binning routines changed                    */
/*                                                                           */
/* - First attempts for "adjoint" detector types                             */
/*                                                                           */
/* - "Importance mesh" plots                                                 */
/*                                                                           */
/* - Implementation of the on-the-fly temperature treatment routine          */
/*                                                                           */
/* - "Coarse multi-group rejection method" seems to work. The performance is */
/*   very good in optimization mode 2, calculation time increases in other   */
/*   modes.                                                                  */
/*                                                                           */
/* - NOTE: a LOT of work was carried out between versions 2.0.37 and 2.0.38, */
/*         including re-writing some major parts of the code. Most of the    */
/*         changes are not documented, and version 2.0.38 should be viewed   */
/*         as the starting point for preparing the source code for           */
/*         beta-testing.                                                     */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.39 (2011/11/20):                                              */
/*                                                                           */
/* - All data structures and OpenMP parallelization reconfigured.            */
/*   Scalability in transport routine is now reasonably good up to 12        */
/*   threads. Burnup and processing routines should be better.               */
/*                                                                           */
/* - Optimization of CRAM routines.                                          */
/*                                                                           */
/* - Data blocks are made ready for implementing MPI parallelization.        */
/*                                                                           */
/* - Calculation of fission source entropies rewritten.                      */
/*                                                                           */
/* - Reaction lists parallelized (20.11.2011)                                */
/*                                                                           */
/* - Pebble bed power distributions                                          */
/*                                                                           */
/* - NOTE1: There is a pointer error (VALID_PTR used with RES2) in most of   */
/*          the backups dated before 2011.11.19. Fixed by allocating enough  */
/*          memory to allow pointer checks.                                  */
/*                                                                           */
/* - NOTE2: Serpent 2 generally runs slower than Serpent 1. This wasn't      */
/*          always the case --> why???                                       */
/*                                                                           */
/* - TODO: Consider using similar approach as with entropy calculation for   */
/*         source biasing (or even the same mesh)                            */
/*                                                                           */
/* - TODO: ReducePrivateRes() vie aika paljon CPU-aikaa kun koko blokki      */
/*         redusoidaan joka kerta. Homman voisi jakaa alueisiin sen mukaan   */
/*         mitä oikeasti tarvitaan.                                          */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.0.40 (2011/01/26):                                              */
/*                                                                           */
/* - CalculateDTMajorants() OpenMP parallelized                              */
/*                                                                           */
/* - OpenMP routines tested in burnup calculation with optimization modes    */
/*   1, 2 and 4. Some bugs fixed.                                            */
/*                                                                           */
/* - B1 fundamental mode calculation routines implemented with methods from  */
/*   Serpent 1.                                                              */
/*                                                                           */
/* - Bug fix: plotter mode always on in FindUniverseCell(). Problem possibly */
/*   related to NOTE2 in previous update.                                    */
/*                                                                           */
/* - mpicc compiler cannot apparently handle calloc(), realloc() and free()  */
/*   functions correctly without explicitly set critical pragmas. The        */
/*   function calls are replaced subroutines where the barriers are set.     */
/*   There may still be problems if one thread calls calloc() and another    */
/*   calls realloc() or free(). If this is the case, the new functions must  */
/*   be replaced by a single routine that handles all memory allocation and  */
/*   free operations inside the same barrier.                                */
/*                                                                           */
/* - Monte Carlo volume calculator fixed and OpenMP parallelized.            */
/*                                                                           */
/* - Temperature feedback routines added.                                    */
/*                                                                           */
/* - Versionumerointi ei mee ihan oikein ennen 26.1.2012 tehtyjä bäckuppeja, */
/*   eikä muutenkaan samalla tavalla kuin Serpent 1:ssä. Samaa käytäntöä     */
/*   aletaan soveltamaan versiosta 2.1.0 eteenpäin.                          */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.0 (2012/02/03):                                               */
/*                                                                           */
/* - First widely distributed beta version.                                  */
/*                                                                           */
/* - Decay only mode fixed.                                                  */
/*                                                                           */
/* - Search for last xs point in processxsdata() changed.                    */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.1 (2012/02/06):                                               */
/*                                                                           */
/* - External souce mode fixed.                                              */
/*                                                                           */
/* - Gamma transport mode fixed (runs, but not tested).                      */
/*                                                                           */
/* - Non-reproducible MPI -mode fixed (?).                                   */
/*                                                                           */
/* - MPI parallelization added in external source calculation.               */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.2 (2012/02/13):                                               */
/*                                                                           */
/* - Added a check that terminates calculation in non-64-bit systems.        */
/*                                                                           */
/* - More work done on gamma transport simulation (composition from neutron  */
/*   transport problem, detector response functions -25 and -26, etc.).      */
/*                                                                           */
/* - The "externally coupled burnup mode" removed to simplify some routines. */
/*                                                                           */
/* - Particle disperser routine adopted from Serpent 1.                      */
/*                                                                           */
/* - Fixed indexing error in calculatetransmuxs.c.                           */
/*                                                                           */
/* - Thinning tolerance automatically set to zero when microscopic cross     */
/*   sections are not reconstructed (optimization mode 3).                   */
/*                                                                           */
/* - Fixed a bug related to optimization mode 1 in calculatetransmuxs.c.     */
/*   (not the one that causes segmentation fault with OpenMP)                */
/*                                                                           */
/* - Fixed a bug related to GC universes in matlaboutput.c.                  */
/*                                                                           */
/* - Union operator enabled (some bugs fixed in readinfix.c).                */
/*                                                                           */
/* - Some group constants added and fixed.                                   */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.3 (2012/03/02):                                               */
/*                                                                           */
/* - Density factors and first ideas of a multi-physics interface.           */
/*                                                                           */
/* - Got rid of annoying warning message about missing photon data.          */
/*                                                                           */
/* - Mesh plotter routine changed.                                           */
/*                                                                           */
/* - DT efficiency added in mesh plotter.                                    */
/*                                                                           */
/* - Fixed broken gamma transport mode (error in wgt2 in collision.c).       */
/*                                                                           */
/* - Sorted seek mode in seeklist.c                                          */
/*                                                                           */
/* - Fixed a problem related to composition lists (closed twice when         */
/*   mixtures are used)                                                      */
/*                                                                           */
/* - Fixed a pointer error in processdetectors.c                             */
/*                                                                           */
/* - Added plane defined by three points                                     */
/*                                                                           */
/* - Fixed a pointer error in calculatetransmuxs.c                           */
/*                                                                           */
/* - Fixed missing argument for Die() in processuresdata.c                   */
/*                                                                           */
/* - log-log interpolation added for ures data                               */
/*                                                                           */
/* - Compatibility with Intel C-compiler                                     */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.4 (2012/04/04):                                               */
/*                                                                           */
/* - Analog estimators for total microscopic reaction rates                  */
/*                                                                           */
/* - B1 mode fixed and added option to run solver after each criticality     */
/*   cycle to get relative statistical errors. Flux correction also          */
/*   implemented in burnup calculation, but it doesn't work with ures        */
/*   sampling yet.                                                           */
/*                                                                           */
/* - Radioactive decay source for photon transport added (radgammasrc.c).    */
/*   Normalization is not done correctly, so the results cannot be right     */
/*   either.                                                                 */
/*                                                                           */
/* - Source read routine added (readsourcefile.c)                            */
/*                                                                           */
/* - Added routine usersurf.c to simplify the development of new surface     */
/*   types.                                                                  */
/*                                                                           */
/* - Added routine usersr.c for user-defined sources                         */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.5 (2012/05/09):                                               */
/*                                                                           */
/* - Decay-nuklidien käsittelyä alkuperäisessä koostumuksessa muutettu.      */
/*                                                                           */
/* - Track plotter implemented ("set tpl" or command line option "-tracks"). */
/*                                                                           */
/* - 3D lattice types (11, 12, 13) adopted from Serpent 1.1.17               */
/*                                                                           */
/* - "Source biasing" method revised and renamed UFS                         */
/*                                                                           */
/* - Batching interval adopted from Serpent 1.1.17                           */
/*                                                                           */
/* - Bug fix: Incorrect fixed branching ratio of Am-243 (also corrected in   */
/*   Serpent 1.1.17)                                                         */
/*                                                                           */
/* - Root universe can be set explicitly (not necessarily "0")               */
/*                                                                           */
/* - Changes in multi-physics interface and additional type (user-defined    */
/*   distribution, type 3).                                                  */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.6 (2012/06/08):                                               */
/*                                                                           */
/* - Bug fix: boundary check in meshindex.c.                                 */
/*                                                                           */
/* - Major changes in burnup routines. Division into "depletion zones"       */
/*   (div-card) in addition to the old Serpent 1 -type approach.             */
/*                                                                           */
/* - Option to print divided, sum of divided or both material compositions   */
/*   in depletion output "set depout").                                      */
/*                                                                           */
/* - Monte Carlo volume calculation routine revised. The routine can now     */
/*   be used to calculate volumes before running the transport simulation.   */
/*   The hierarchy (what overrides what) is: user input > MC volume          */
/*   calculation routine > volumes calculated by Serpent.                    */
/*                                                                           */
/* - Pre-defined material compositions for neutron and photon transport      */
/*   calculations printed as a command-line option ("-comp", subroutine      */
/*   stdcomp.c).                                                             */
/*                                                                           */
/* - Track plots produced in separate png files with adjusted palette to     */
/*   distinguish the tracks from background.                                 */
/*                                                                           */
/* - Added blockdt and forcedt options and revised the selection between     */
/*   DT and ST. Option "set dt 1.0" sets full delta-tracking mode and        */
/*   "set dt 0.0" full surface-tracking mode. Serpent 1 uses surface-        */
/*   tracking when sampling track lengths in void, even if the threshold     */
/*   is set to 1.0.                                                          */
/*                                                                           */
/* - Added a 64-bit check in Makefile.                                       */
/*                                                                           */
/* - Bug fix: Surface distance calculation for "pad" surface type.           */
/*                                                                           */
/* - Bug fix: Incorrect order of input parameters in mesh detectors.         */
/*                                                                           */
/* - Bug fix: Partially reflected boundary conditions for cubes and          */
/*            cuboids.                                                       */
/*                                                                           */
/* - Pre-allocated work arrays to reduce memory allocation calls in          */
/*   OpenMP-parallelized routines                                            */
/*                                                                           */
/* - Changed default handling mode of RES2 array to shared (parameter        */
/*   DATA_OPTI_SHARED_RES2), since this seems to improve the parallel        */
/*   scalability of burnup routines (may not be the case when mesh plots     */
/*   are used)                                                               */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.7 (2012/06/15):                                               */
/*                                                                           */
/* - Calculation of delayed neutron and P1 diffusion parameters from         */
/*   Serpent 1.                                                              */
/*                                                                           */
/* - Bug fix: division of material regions with S(a,b) data.                 */
/*                                                                           */
/* - Albedo boundary conditions added but not really tested. No iteration    */
/*   yet.                                                                    */
/*                                                                           */
/* - Universe symmetries.                                                    */
/*                                                                           */
/* - Corrected a flaw that hangs calculation in processmaterials.c if        */
/*   number of burnable materials is large (sorting).                        */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.8 (2012/09/07):                                               */
/*                                                                           */
/* - Default cross section data library from SERPENT_ACELIB                  */
/*                                                                           */
/* - Bug fix: UFS fixed (missing call to scoreufs.c).                        */
/*                                                                           */
/* - Bug fix: Depletion output flag for undivided materials.                 */
/*                                                                           */
/* - Bug fix: Burnable materials in non-burnup mode (no dep-card)            */
/*                                                                           */
/* - Bug fix: Detector response when reaction is not defined (rakenteeseen   */
/*            DET_RESPONSE_VOID_MODE -flagi, joka hoitaa saman homman kuin   */
/*            null pointteri aikaisemmin - ei ole juurikaan testattu).       */
/*                                                                           */
/* - Added macroscopic fission energy production cross section in reaction   */
/*   lists.                                                                  */
/*                                                                           */
/* - Bug fix: Number of arguments in input parameters                        */
/*                                                                           */
/* - Boundary conditions and surface current detector revised (Similar to    */
/*   Serpent 1.1.18).                                                        */
/*                                                                           */
/* - Pre-defined nuclide lists for inventory and top n contributor option.   */
/*                                                                           */
/* - Bug fix: Doppler-broadening preprocessor with thermal scattering data   */
/*                                                                           */
/* - Bug fix: Core power distributions in 2 level geometries (also changed   */
/*            the names of the output variables).                            */
/*                                                                           */
/* - Temperature feedback routine completely revised                         */
/*                                                                           */
/* - Added cell volume calculation routine for simple cell types             */
/*                                                                           */
/* - Preprocessor routine started                                            */
/*                                                                           */
/* - Several analog time estimators added                                    */
/*                                                                           */
/* - Super-imposed cells and universes in detector calculation               */
/*                                                                           */
/* - Bug fix: Use of density factors with multi-group majorant cross         */
/*            sections.                                                      */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.9 (2012/10/22):                                               */
/*                                                                           */
/* - Surface defined by three points fixed.                                  */
/*                                                                           */
/* - Density distributions from the multi-physics interface included in      */
/*   geometry plots.                                                         */
/*                                                                           */
/* - Interface input and processing routines revised.                        */
/*                                                                           */
/* - First attempt to add CGNS-type multi-physics interface.                 */
/*                                                                           */
/* - Added sorting for stochastic geometry search list (and CGNS)            */
/*                                                                           */
/* - Added time bins for detectors                                           */
/*                                                                           */
/* - Beta eff's divided into analog and implicit estimators                  */
/*                                                                           */
/* - Development of dynamic mode started by dividing source calculation into */
/*   time intervals                                                          */
/*                                                                           */
/* - Transport cycle and tracking routine completely revised (population is  */
/*   no longer dynamically allocated)                                        */
/*                                                                           */
/* - Main data blocks are no longer reallocated in OpenMP parallel loops     */
/*   --> this should remove the occasional segfaults and produce an error    */
/*   message if memory allocation is attempted at the wrong place.           */
/*                                                                           */
/* - Track plotter works with periodic and reflecive boundary conditions     */
/*                                                                           */
/* - Calculation of time constants revised (work not yet completed)          */
/*                                                                           */
/* - Bug fix: Volume input for divided materials                             */
/*                                                                           */
/* - NOTE: Fissioneutronien lukumäärän arpomista lähdemoodissa muutettiin!   */
/*         (aliohjelma fission.c)                                            */
/*                                                                           */
/* - Quick-plot mode added                                                   */
/*                                                                           */
/* - MPI reproducibility is not as good as it used to be (?)                 */
/*                                                                           */
/* - Detector scores written into source file ("df" entry)                   */
/*                                                                           */
/* - Criticality source from active cycles written in file ("set scw")       */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.10 (2012/12/12):                                              */
/*                                                                           */
/* - Bug fix: energy boundaries for DBRC                                     */
/*                                                                           */
/* - Bug fix: free-gas model and otf temperature treatment routine           */
/*                                                                           */
/* - Bug fix: Dopper preprocessor and nuclides broadened to several          */
/*            temperatures                                                   */
/*                                                                           */
/* - Bug fix: Mesh binning in detectors and z-binning in interface power     */
/*                                                                           */
/* - Bug fix: Pointer error in calculateuresmajorants.c (direct pointer with */
/*            memory allocation)                                             */
/*                                                                           */
/* - Temperature feedback in source mode                                     */
/*                                                                           */
/* - Dynamic simulation mode implemented (M&C 2012 paper)                    */
/*                                                                           */
/* - ReduceBuffer() -kutsua muutettiin niin että dynaamisessa lähdemoodissa  */
/*   data voidaan hakea jo ensimmäisen aikavälin jälkeen normeerauskertoimen */
/*   laskemista varten.                                                      */
/*                                                                           */
/* - Transport cross section and diffusion coefficient calculated in B1      */
/*   with correct infinite-spectrum weighting                                */
/*                                                                           */
/* - Calculation of scattering production cross sections changed (reaction   */
/*   list now includes only the production reactions)                        */
/*                                                                           */
/* - Made some changes in the Serpent 1 type division of burnable materials  */
/*   (to speed up the initialization of very large problems)                 */
/*                                                                           */
/* - Generation of a secondary data block for low-energy cross sections,     */
/*   in which values are indexed in cache-optimized order --> up to 25%      */
/*   speed-up in optimization mode 1.                                        */
/*                                                                           */
/* - Added radial binning in IFC output -- NOTE: input format changed!       */
/*                                                                           */
/* - Some optimization done for spectrum-collapse method when ures sampling  */
/*   is in use                                                               */
/*                                                                           */
/* - Fission product poison cross sections added                             */
/*                                                                           */
/* - Equilibrium Xe-135 calculation added (and Sm-149, but the results are   */
/*   no good)                                                                */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.11 (2012/12/14):                                              */
/*                                                                           */
/* - Bug fix: Index check in scoreinterfacepower.c (debug mode)              */
/*                                                                           */
/* - Bug fix: Energy boundary check with on-the-fly temperature treatment    */
/*            routine                                                        */
/*                                                                           */
/* - Bug fix: Density factor and integral reaction rates                     */
/*                                                                           */
/* - Bug fix: Implicit estimators of k-eff and k-inf in optimization modes 1 */
/*            and 2                                                          */
/*                                                                           */
/* - Identified problem: interface output does not work with universe        */
/*   symmetries (coordinates are not properly set in findinterfaceregions.c) */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.12 (2013/02/04):                                              */
/*                                                                           */
/* - Bug fix: batching was disabled in MPITransfer() and some routines       */
/*            had direct calls to MPI_Reduce() and MPI_Bcast.                */
/*                                                                           */
/* - Bug fix: score batching and inactive cycles.                            */
/*                                                                           */
/* - Bug fix: no convergence condition in B1 routine when equations are      */
/*            solved after every cycle.                                      */
/*                                                                           */
/* - Bug fix: microscopic total xs was not available for detector response.  */
/*                                                                           */
/* - Bug fix: wrong reaction in poison calculation -- total abs did not work */
/*            for some reason and it was changed to (n,gamma).               */
/*                                                                           */
/* - Bug fix: equilibrium Sm-149 calculation seems to work (?).              */
/*                                                                           */
/* - MPI batch size added as input variable ("set mbtch").                   */
/*                                                                           */
/* - Random number seed taken from environment variable SERPENT_RNG_SEED.    */
/*                                                                           */
/* - Changed the handling of detector mesh bins (uses MESH structure now).   */
/*                                                                           */
/* - New mesh types: cylindrical, spherical, hexagonal                       */
/*                                                                           */
/* - Fission matrix calculation revised and universe-based materixes added.  */
/*                                                                           */
/* - Added generation cut-off.                                               */
/*                                                                           */
/* - Added OpenMP parallelization in collectresults.c, clearbuf.c and        */
/*   reducebuffer.c. (multifysiikkarajapinnan collectointia ei oo testattu)  */
/*   redistributestacks.c on profiloinnissa seuraava.                        */
/*                                                                           */
/* - Cleanup: removed unused variables to suppress warning messages when     */
/*            compiled without -Wno-unused-but-set-variable (aloitettiin     */
/*            28.12.2012, edelleen kesken, esim. sampleendflaw.c ja          */
/*            samplemu lukee jotain kertoimia (c2) joita ei käytetä.         */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.13 (2013/05/03):                                              */
/*                                                                           */
/* - OpenMP parallelization added to Doppler-broadening preprocessor.        */
/*                                                                           */
/* - Various routines handling DBRC and ETTM majorant cross sections         */
/*   re-written, pointer names changed, etc.                                 */
/*                                                                           */
/* - Changed handling of decay nuclides in initial composition (only "fixed" */
/*   compositions allowed).                                                  */
/*                                                                           */
/* - Added parallelepiped in surface types.                                  */
/*                                                                           */
/* - Added surface and level options in coordinate transformations           */
/*                                                                           */
/* - Added I-135 and Pm-149 absorption in poison cross sections (noita ei    */
/*   oteta vielä tasapainolaskuun mukaan)                                    */
/*                                                                           */
/* - Pre-defined energy groups can be entered in set nfg card                */
/*                                                                           */
/* - Bug identified: unions do not work with boundary conditions (added a    */
/*                   check to disallow unions in outside type)               */
/*                                                                           */
/* - Added output routines for ares and cax formats                          */
/*                                                                           */
/* - Bug fix: Missing target pointer for total fission in burnup calculation */
/*            without fission yield distributions.                           */
/*                                                                           */
/* - Bug fix: Strange behaviour if same burnable material is used with cells */
/*            and nests (pins) -- added error check.                         */
/*                                                                           */
/* - Bug fix: Ures data and DBRC nuclides                                    */
/*                                                                           */
/* - Bug fix: Added extra grid point at the boundary between S(a,b) and      */
/*            free atom cross sections                                       */
/*                                                                           */
/* - HUOM: palamalaskussa ei nyt tehdä mitään muita katkaisuja kuin          */
/*         reaktiokatkaisu neutronin minimienergiasta (sama kuin myöhemmin   */
/*         reactioncutoff.c:ssä)                                             */
/*                                                                           */
/* - Changed userdf.c to userifc.c and included temperature distribution     */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.14 (2013/06/28):                                              */
/*                                                                           */
/* - Group constant generation simultaneously at multiple levels             */
/*                                                                           */
/* - Calculation of temperature majorants revised                            */
/*                                                                           */
/* - Cuboid and parallelepiped shapes added in particle disperser            */
/*                                                                           */
/* - Memory preallocation added to processgc.c                               */
/*                                                                           */
/* - Batching added to micro-group calculation                               */
/*                                                                           */
/* - Capability to override compositions of divided burnable materials       */
/*                                                                           */
/* - Corner and surface mid-point currents added for ADF calculation         */
/*                                                                           */
/* - Normalization to single material (tolla pitää korvata kokonaan se       */
/*   nykyinen zydeemi) (tätä ei oo vielä dokumentoitu foorumilla)            */
/*                                                                           */
/* - Bug fix: Calculation of surface distance to planes defined by three     */
/*            points                                                         */
/*                                                                           */
/* - Bug fix: Calculation of surface distance to parallelepiped              */
/*                                                                           */
/* - Bug fix: Pointer error (surface parameters) in scoredf.c                */
/*                                                                           */
/* - Bug fix: Generation of transmutation paths when detector materials are  */
/*            present                                                        */
/*                                                                           */
/* - Bug fix: Track-length estimator used for calculating DF_HET_VOL_FLUX    */
/*            (tossa on edelleen pieni mutta merkittävä ero INF_FLX:ään)     */
/*                                                                           */
/* - Bug fix: Maximum number of colors in geometry plot                      */
/*                                                                           */
/* - Bug fix: reading of ACE files containing trailing white space           */
/*                                                                           */
/* - Bug fix: ures dilution cutoff for nuclides with S(a,b) data             */
/*                                                                           */
/* - ifcpointc.c:n lopussa oleva if-hässäkkä kommentoitiin yli 26.6.2013     */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.15 (2013/07/31):                                              */
/*                                                                           */
/* - Bug fix: Depletion zone division and explicit stochastig geometry       */
/*                                                                           */
/* - Bug fix: Unnecessary sanity checks in normalizecomposition.c            */
/*                                                                           */
/* - Bug fix: Material entries in dr with MT -15                             */
/*                                                                           */
/* - Bug fix: Calculation of maximum nuclide densities in MPI mode           */
/*            (normalizecompostions.c, vaikuttaa URES-flagin asetukseen)     */
/*                                                                           */
/* - Bug fix: NUCLIDE_SUM_ABS_XS lisätty cachexs.c:hen                       */
/*                                                                           */
/* - Bug fix: SIE-related stuff in storetransmuxs.c                          */
/*                                                                           */
/* - Bug fix: zonecount.c:hen lisättiin testaus siitä onko universumeita     */
/*            käytetty useammalla tasolla. Jos näin on, niin se voi joissain */
/*            tilanteissa aiheuttaa pointer errorin (HH:n meili 25.7.2013).  */
/*            Siitä voi tulla muutakin häikkää että universumin ja levelin   */
/*            yhteys ei ole yksikäsitteinen.                                 */
/*                                                                           */
/* - Some changes in decay calculations                                      */
/*                                                                           */
/* - Adjoint-weighted point kinetics parameters completed                    */
/*                                                                           */
/* - Automated division in depletion zones revised ("div sep" -card").       */
/*                                                                           */
/* - Possibility to apply multiple coordinate transformations added.         */
/*                                                                           */
/* - Fission pois kytkeminen toteutettu eri tavalla. REACTION_TY asetetaan   */
/*   nyt nollaksi readacefile.c:ssä, eli fissiot luetaan absorption listaan. */
/*   Tästä seuraa mm. se, että joissain aliohjelmissa fissio pitää vähentää  */
/*   makroskooppisesta kokonaisvaikutusalasta.                               */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.16 (2013/12/23):                                              */
/*                                                                           */
/* - Line number checking switched off for large input files                 */
/*                                                                           */
/* - Bug fix: Handling of scattering probabilities in nested group constant  */
/*            universes.                                                     */
/*                                                                           */
/* - Bug fix: Detectors divided or multiplied by other detectors.            */
/*                                                                           */
/* - Bug fix: Character string overflow in timestr.c                         */
/*                                                                           */
/* - Bug fix: Cross sections carried over to decay steps run after burnup    */
/*            calculation.                                                   */
/*                                                                           */
/* - Bug fix: Default plot plane in geometry plotter (changed from zero to   */
/*            mid-way between min and max).                                  */
/*                                                                           */
/* - Bug fix: Neutron grid unionization in gamma transport mode.             */
/*                                                                           */
/* - Bug fix: Insufficient gamma buffer size for OpenMP parallelization.     */
/*                                                                           */
/* - Bug fix: Cell search in source routine.                                 */
/*                                                                           */
/* - Bug fix: Surface-tracking in cuboidal lattice type.                     */
/*                                                                           */
/* - Bug fix: Normalization of power or power density to single material.    */
/*                                                                           */
/* - Bug fix: Divisor card (sep-entry) when divided material is not at top   */
/*            level.                                                         */
/*                                                                           */
/* - Bug fix: Unconverged B1 batch excluded from results.                    */
/*                                                                           */
/* - Bug fix: Improved calculation of material-wise burnups.                 */
/*                                                                           */
/* - Bug fix: Format error in endfcolf.c                                     */
/*                                                                           */
/* - Adjusted TTA cut-off from 1E-18 to 1E-28                                */
/*                                                                           */
/* - Added ICM stuff.                                                        */
/*                                                                           */
/* - Added input parameter for output print interval ("set outp")            */
/*                                                                           */
/* - Added iteration of albedo boundary conditions.                          */
/*                                                                           */
/* - OpenFOAM format multi-physics interface                                 */
/*                                                                           */
/* - OpenFOAM format unstructured mesh based geometry type                   */
/*                                                                           */
/* - addbranching.c:stä karsittiin tarpeetonta muistinvarausta reaktioille   */
/*   jotka ei ota osaa palamalaskuun.                                        */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.17 (2014/02/24):                                              */
/*                                                                           */
/* - Some changes in readinterface.c: source code for reading OpenFOAM       */
/*   format data copied from readumshgeometry.c, alternative routine for     */
/*   reading OpenFOAM file format without modifications (the two formats     */
/*   are separated by #ifdef structure in readinterface.c)                   */
/*                                                                           */
/* - Added routine WriteCGNStoGeo() for converting unstructured mesh based   */
/*   interfaces to geometry files (called from main.c, requires disabling    */
/*   an if-statement)                                                        */
/*                                                                           */
/* - Added some diagnostics for infinite tracking loop / lost particles      */
/*   (new subroutine trackingerror.c)                                        */
/*                                                                           */
/* - OpenFOAM mesh conversion to tetrahedral type                            */
/*                                                                           */
/* - Restart feature added ("set rfw" and "set rfr")                         */
/*                                                                           */
/* - Added overrideids.c to override nuclide ID's entered in the input       */
/*   (tästä tulee osa branching-ominaisuutta)                                */
/*                                                                           */
/* - Added super-imposed volume flux detector based on track-length          */
/*   estimator (type "dtl")                                                  */
/*                                                                           */
/* - Added capability to use dosimetry data with detectors                   */
/*                                                                           */
/* - Some cleanup in processinventory.c                                      */
/*                                                                           */
/* - Track plotter revised                                                   */
/*                                                                           */
/* - Added statistical testing of results                                    */
/*                                                                           */
/* - Bug fix: Pointer error in creategeometry.c                              */
/*                                                                           */
/* - Bug fix: S(a,b) nuclides in transmutation paths, removal of duplicates  */
/*   based on ZAI alone (added comparison of temperature, kts. JJ:n meili    */
/*   3.2.2014)                                                               */
/*                                                                           */
/* - Bug fix: Indexing error in detector divisors/multipliers                */
/*                                                                           */
/* - Bug fix: Detector output for hex types                                  */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.18 (2014/02/27):                                              */
/*                                                                           */
/* - Some general cleanup: removed polyplane surface type and TestPlane()    */
/*   subroutine, obsolete Serpent 1 style group constants removed (can be    */
/*   included by defining SERPENT1_GC), "ETTM" replaced with "TMS".          */
/*                                                                           */
/* - AllocPrivateData() modified: existing memory is no longer copied in the */
/*   new data block. This should not be a problem, but there is a chance     */
/*   that some data is lost in the process. If the calculation fails,        */
/*   try re-running with 2.1.17                                              */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.19 (2014/03/31):                                              */
/*                                                                           */
/* - Bug fix: Limited temporary array length in puttext.c                    */
/*                                                                           */
/* - Bug fix: Depletion zone division hangs in large particle fuel           */
/*            geometries (change loop over particles to loop over particle   */
/*            types in makedepletionzones.c)                                 */
/*                                                                           */
/* - Bug fix: Comparison of decimal values in readrestartfile.c              */
/*                                                                           */
/* - Added type flags for temperature and density distributions of OpenFOAM  */
/*   multi-physics interface.                                                */
/*                                                                           */
/* - Added output for OpenFOAM interface. NOTE: printinterfaceoutput.c       */
/*   was modified -- files with identical names are no longer appended.      */
/*                                                                           */
/* - Handling of unstructured mesh based geometries completely revised       */
/*   (now consistent with the corresponding multi-physics interface)         */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.20 (2014/04/07):                                              */
/*                                                                           */
/* - Added fission neutron production cross section in reaction lists        */
/*   NOTE: This changes the way group constants and icm data are scored      */
/*   (analog nubar replaced by nsf).                                         */
/*                                                                           */
/* - Added NSF (mt -7) and scattering recoil energy deposition (mt -10)      */
/*   in detector reactions.                                                  */
/*                                                                           */
/* - Bug fix: energy boundary between unbound and S(a,b) data when           */
/*   microscopic cross sections are not reconstructed.                       */
/*                                                                           */
/* - Tried to optimize RandF(). Function Rand64() is now obsolete.           */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.21 (2014/06/11):                                              */
/*                                                                           */
/* - Bug fix: Added missing cumulative option in detectors                   */
/*                                                                           */
/* - Bug fix: pointer error in score.c (null pointer for TOT_ABSXS)          */
/*                                                                           */
/* - Bug fix: multiple burnable materials in pin structure and burnable      */
/*            material in the outermost region                               */
/*                                                                           */
/* - Bug fix: branching ratio of Ag-109                                      */
/*                                                                           */
/* - Bug fix: Call to ColDet() made twice per each scattering                */
/*                                                                           */
/* - Bug fix: Handling of zero energy value in makeenergygrid.c              */
/*                                                                           */
/* - Bug fix: total nubars when delayed neutron emission is switched off     */
/*                                                                           */
/* - Bug fix: poison xs calculation pointers and flags not copied to divide  */
/*            materials                                                      */
/*                                                                           */
/* - New fixed branching ratios calculated from energy-dependent JEFF-3.1    */
/*   activation data (PWR flux spectrum).                                    */
/*                                                                           */
/* - Lost transmutation paths to isomeric states linked directly to ground   */
/*   state nuclides (if available).                                          */
/*                                                                           */
/* - Revised the handling of implicit fission (ei vieläkään toimi)           */
/*                                                                           */
/* - Changed the naming conventions related to unstructured meshes. Term     */
/*   "CGNS" is now reserved to the new interface type to be implemented.     */
/*   The internal structure is from now on refered to as "tetrahedral mesh"  */
/*   and the conversion routines with term "polyhedral mesh".                */
/*                                                                           */
/* - Started working on automated depletion sequence for group constant      */
/*   generation                                                              */
/*                                                                           */
/* - Started work on homogeneous diffusion flux solver                       */
/*                                                                           */
/* - Added symmetry option for ADF's (NOTE: change in syntax)                */
/*                                                                           */
/* - Added lattice option to UFS (NOTE: globaalit koordinaatit)              */
/*                                                                           */
/* - NUCLIDE_NEW_DAUGHTERS -flägin asettamista muutettiin                    */
/*   formtransmupath.c:ssä (ei tarkkaan muista minkä takia se alunperin on   */
/*   lisätty, mutta voi olla että liittyy mm. aktinidi- ja fissiotuote-      */
/*   listojen generointiin.                                                  */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.22 (2014/11/27):                                              */
/*                                                                           */
/* - Bug fix: return value of hisval.c not divided by number of MPI tasks.   */
/*                                                                           */
/* - Bug fix: Pointer error in processymmetries.c.                           */
/*                                                                           */
/* - Bug fix: GC calculation batch counter not updated in external           */
/*            source simulation mode.                                        */
/*                                                                           */
/* - Bug fix: -rdep command line option.                                     */
/*                                                                           */
/* - Bug fix: MPI initialization and finalization moved outside branch loop. */
/*                                                                           */
/* - Bug fix: Skip B1 calculation if k < 0.5 to avoid fatal error.           */
/*            NOTE: B1-vakiot korvataan tällöin INF-vakioilla. Tämä pitää    */
/*            dokumentoida. Ongelmia saattaa esiintyä jos k ~ 0.5, ja        */
/*            ja vain osa B1-laskuista skipataan.                            */
/*                                                                           */
/* - Bug fix: Undefined temperature in multi-physics interface.              */
/*                                                                           */
/* - Bug fix: Interpolation types for ENDF laws 4/44/61 read into vector     */
/*            instead of using the first one listed.                         */
/*                                                                           */
/* - Bug fix: STL geometry routines completely rewritten. Also the input     */
/*            format was changed.                                            */
/*                                                                           */
/* - Spectrum-collapse method forced off in optimization modes 1 and 3.      */
/*                                                                           */
/* - Added homogeneous diffusion flux solver, revised calculation of ADF's   */
/*   and pin-power distributions / form factors.                             */
/*                                                                           */
/* - Added new printing routine for matlaboutput.c                           */
/*                                                                           */
/* - Added calculation of partial albedos (NOTE: se matriisi saattaa tulla   */
/*   nyt transponoituna --> korjaa)                                          */
/*                                                                           */
/* - Added support for new ACE format.                                       */
/*                                                                           */
/* - Wielandt shift implemented                                              */
/*                                                                           */
/* - Tracking routine revised (handling of surface-based tallies).           */
/*                                                                           */
/* - Added option to score detectors only in fissile materials (by setting   */
/*   material name to "fiss"). Huom! ton kanssa ei voi nyt määritellä muita  */
/*   materiaalibinejä. Voisi olla parempi laittaa toi responseen.            */
/*                                                                           */
/* - Changed the calculation of B1_TRANSPXS to be consistent with            */
/*   INF_TRANSPXS, only with critical-spectrum weighting. B1_DIFFCOEF        */
/*   was not changed, so equivalence D = 1/(3*Sigma_tr) no longer holds      */
/*   for the B1_ constants.                                                  */
/*                                                                           */
/* - Added support for new ACE naming convention (HUOM: Lib ID:t menee       */
/*   väärin sillä oletetaan 3 merkin pituinen stringi).                      */
/*                                                                           */
/* - Added delayed neutron parameters in group constant generation           */
/*   (NOTE: uses Meulekamp's method for now)                                 */
/*                                                                           */
/* - Added support for reaction mt 5 (combination of multiple channels)      */
/*   NOTE: tolle ei ole implisiittistä estimaattoria !!!                     */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.23 (2015/03/24):                                              */
/*                                                                           */
/* - Bug fix: Close to zero boundary currents in homoflux.c                  */
/*                                                                           */
/* - Bug fix: calcmicroxs.c called from corrector steps                      */
/*                                                                           */
/* - Bug fix: stopatboundary.c incomplete                                    */
/*                                                                           */
/* - Bug fix: recoil energy detector (finally)                               */
/*                                                                           */
/* - Bug fix: testasciifile.c (switched fgetc to fread)                      */
/*                                                                           */
/* - Bug fix: Unassigned value in depletion algorithms (LE)                  */
/*                                                                           */
/* - Bug fix: Handling of reflective boundary conditions                     */
/*                                                                           */
/* - Bug fix: Indexing in fission matrix calculation                         */
/*                                                                           */
/* - Bug fix: Identify umlauts in testdosfile.c and testasciifile.c          */
/*                                                                           */
/* - Handling of detector cell and material bins optimized (NOTE: nested     */
/*   cell structures in cell bins no longer work)                            */
/*                                                                           */
/* - Added option to exclude corners from diffusion flux solver              */
/*                                                                           */
/* - Added infinite rectangular cylinder surface type ("rect")               */
/*                                                                           */
/* - Added branch indexes in detectoroutput.c                                */
/*                                                                           */
/* - Added direction vector in detectors for tallying angular current        */
/*   density                                                                 */
/*                                                                           */
/* - Added source plot routine in mesh plotter                               */
/*                                                                           */
/* - Grow and shake algorithm added in disperser routine (implemented by     */
/*   Cole Gentry from University of Tennessee).                              */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.24 (2015/06/25):                                              */
/*                                                                           */
/* - Bug fix: TMS temperature limits with poison calculation                 */
/*                                                                           */
/* - Bug fix: Indexing error in IFC palette with burnable materials          */
/*                                                                           */
/* - Bug fix: Division by zero in storetransmuxs.c and relaxtransmuxs.c      */
/*                                                                           */
/* - Bug fix: Units check in readifcofmesh.c                                 */
/*                                                                           */
/* - Bug fix: Reseting nuclide density vector in printdepoutput.c            */
/*                                                                           */
/* - Bug fix: Error check in boundaryconditions.c                            */
/*                                                                           */
/* - Bug fix: Poison nuclides included in detector materials                 */
/*                                                                           */
/* - Bug fix: U235 fission energy from input not converted to J              */
/*                                                                           */
/* - Bug fix: Total fission missing in ClearTransmuXS()                      */
/*                                                                           */
/* - Bug fix: log interpolations in user-defined response functions          */
/*                                                                           */
/* - TestXS() revived.                                                       */
/*                                                                           */
/* - Added source distribution in detector response functions, mesh plot     */
/*   type 14 is no longer supported.                                         */
/*                                                                           */
/* - Added compile date, hostname and working directory in main output       */
/*                                                                           */
/* - Added option to read STL body names from file ("-1" entry)              */
/*                                                                           */
/* - Random number seeds stored to a separate unsigned long type array       */
/*                                                                           */
/* - New photon physics, decay source mode, photon dose rate detectors       */
/*                                                                           */
/* - Interpolation of S(a,b) data added                                      */
/*                                                                           */
/* - Added hexagonal mesh in multi-physics interface                         */
/*                                                                           */
/* - Added OpenMP parallelization in tmpmajorants.c                          */
/*                                                                           */
/* - Added uniform time interval option in source sampling ("st")            */
/*                                                                           */
/* - NOTE: Lähderutiinia muutettiin (esptt3m111 / 3.6.2015). Voi olla ettei  */
/*         kaikki enää pelaa ihan oikein.                                    */
/*                                                                           */
/* - Changed handling of STL geometries (uusi syntaksi, poista ne vanhat     */
/*   rakenteet readstlgeometry.c:stä ja processstlgeometry.c:stä)            */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.25 (2016/02/23):                                              */
/*                                                                           */
/* - Added option to print isotopic compositions of natural elements.        */
/*                                                                           */
/* - Added option in set depout to depress intermediate output printing.     */
/*                                                                           */
/* - Added Cartesian mesh in depletion zone division and extra zone for      */
/*   region outside mesh.                                                    */
/*                                                                           */
/* - Added printing of infinite and critical spectrum in matlab output       */
/*   variables INF_MICRO_FLX and B1_MICRO_FLX. Also the order of printed     */
/*   energy boundaries reversed. (NOTE: the fluxes are not divided by energy */
/*   or lethargy width of the groups).                                       */
/*                                                                           */
/* - Added command line options to run only history and restarts in          */
/*   coefficient calculation.                                                */
/*                                                                           */
/* - Added heat production (MT 301 / -4) and gamma production (MT 202 / -5)  */
/*   cross sections (NOTE: heat production is in MeV and automatically       */
/*   multiplied by total xs). This may not work in all modes, and the xs     */
/*   are switched off by default. The data is included if detectors are      */
/*   used.                                                                   */
/*                                                                           */
/* - Extended the range of processed reaction mt's from 16 to 11, to include */
/*   (n,2nd).                                                                */
/*                                                                           */
/* - Added activation burnup mode (cross sections not updated after first    */
/*   step) NOTE: burnup and other neutronics results not calculated.         */
/*                                                                           */
/* - Several routines related to unresolved resonance probability table      */
/*   sampling rewritten.                                                     */
/*                                                                           */
/* - Use of interfaces extended to mixtures                                  */
/*                                                                           */
/* - Added importance maps and boundary options to geometry plotter.         */
/*                                                                           */
/* - Track plotter routines revised                                          */
/*                                                                           */
/* - Added an alternative surface-tracking mode                              */
/*                                                                           */
/* - Calculation of line numbers in input file optimized                     */
/*                                                                           */
/* - Added fill transformation (works with cells only, mainly for            */
/*   compatibility with MCNP)                                                */
/*                                                                           */
/* - Added MCNP style complement operator '#' in cell surface lists          */
/*                                                                           */
/* - Added MCNP style K/X, K/Y and K/Z cones (surface types ckx, cky, ckz)   */
/*                                                                           */
/* - Added torii (numerical solution of 4th-order polynomial roots)          */
/*                                                                           */
/* - Added MCNP style X, Y, and Z surfaces (only one or two points           */
/*   supported for now)                                                      */
/*                                                                           */
/* - Added infite cylinder with axis on vector (cylv)                        */
/*                                                                           */
/* - Added history index and seed in error messages                          */
/*                                                                           */
/* - Upper limit of neutron physics increased to 200 MeV (initial value of   */
/*   DATA_NEUTRON_EMAX and sanity checks in physics routines). Tested with   */
/*   FENDL-3.0 data. HUOM!!! muuta toi raja takas 20 MeV ja ohjeista nosta-  */
/*   maan "set egrid":illä jos tarvis.                                       */
/*                                                                           */
/* - Insertion sort implemented in SortList() NOTE: all fails if this        */
/*   doesn't work.                                                           */
/*                                                                           */
/* - coldet.c divided into multiple subroutines                              */
/*                                                                           */
/* - Photon pulse-height detector added (response function -27)              */
/*                                                                           */
/* - Removed Profile() as useless                                            */
/*                                                                           */
/* - Added the capability for time dependent simulations with delayed        */
/*   neutrons.                                                               */
/*                                                                           */
/* - Added (internal) capability to read and write neutron source files in   */
/*   binary mode.                                                            */
/*                                                                           */
/* - Coupled calculations with fuel behavior interface now write out some    */
/*   convergence information.                                                */
/*                                                                           */
/* - Added support for FINIX 0.15.6 and revised the input syntax for the     */
/*   fuel behavior module.                                                   */
/*                                                                           */
/* - Improved OMP scalability of dynamic simulations by equalizing the       */
/*   particle counts between OMP threads after each generation.              */
/*                                                                           */
/* - Extended the intelligent (less memory consumption) splitting of         */
/*   polyhedral meshes to meshes consisting of a combination of              */
/*   tetrahedrons, prisms, pyramids and hexahedrons.                         */
/*                                                                           */
/* - Added a new interface type based on the OpenFOAM format that allows     */
/*   data for multiple materials to be given in the same interface           */
/*   (ifc type 8).                                                           */
/*                                                                           */
/* - Added a new unstructure mesh based solid format that defines both the   */
/*   geometry and interface based temperature and density data saving memory */
/*   (solid 3).                                                              */
/*                                                                           */
/* - Unstructured mesh based detectors (dumsh) now link each mesh cell to a  */
/*   separate detector bin if a negative number, equal to the number of      */
/*   cells, is given for the number of bins.                                 */
/*                                                                           */
/* - Added input options to control the number of coupled calculation        */
/*   iterations based on the number of iterations (set ccmaxiter) or the     */
/*   population (set ccmaxpop).                                              */
/*                                                                           */
/* - Bug fix: Problem related to thermal scattering nuclides for which the   */
/*            maximum energy of two thermal scattering reactions differ      */
/*            (e.g. H in ZrH).                                               */
/*                                                                           */
/* - Bug fix: New thermal scattering interpolation capabilities in lower     */
/*            optimization modes.                                            */
/*                                                                           */
/* - Bug fix: Handling of nuclide aliases in directory files (search by      */
/*            pointer instead of name). NOTE: This may break something else. */
/*                                                                           */
/* - Bug fix: Gap between free-atom and bound elastic scattering in some     */
/*            in some S(a,b) files.                                          */
/*                                                                           */
/* - Bug fix: interpolation error in ures majorant (fixed by switching to    */
/*            unionized grid)                                                */
/*                                                                           */
/* - Bug fix: same material at mutiple geometry levels in matptr.c           */
/*                                                                           */
/* - Bug fix: Addition of negative values to ures majorant (IFF = 0)         */
/*                                                                           */
/* - Bug fix: Initialization of random number sequence in xsplotter.c        */
/*                                                                           */
/* - Bug fix: Interfaces with divided materials                              */
/*                                                                           */
/* - Bug fix: Use of TMS with branches                                       */
/*                                                                           */
/* - Bug fix: boundary conditions and symmetries with time cut-off           */
/*                                                                           */
/* - Bug fix: S(a,b) names read from aliases in linksabdata.c                */
/*                                                                           */
/* - Bug fix: "set inventory all" with multiple temperatures                 */
/*                                                                           */
/* - Bug fix: calculation of corrected track length in stopatboundary.c      */
/*                                                                           */
/* - Bug fix: batch size in microcalc.c (external source simulation)         */
/*                                                                           */
/* - Bug fix: error message caused by NAN from negative factors avoided      */
/*   by returning 1.0. A warning message was added in processuresdata.c      */
/*   to notify about negative values.                                        */
/*                                                                           */
/* - Bug fix: lattice index 0 ignored in scorecpd.c                          */
/*                                                                           */
/* - Bug fix: thermal scattering id in printcompositions.c                   */
/*                                                                           */
/* - Bug fix: rfr file name overridden in branch calculation (main.c)        */
/*                                                                           */
/* - Bug fix: multiple surface bins in surface current detector              */
/*                                                                           */
/* - Bug fix: Estimation of remaining runtime when fission source passing    */
/*            was used between depletion steps.                              */
/*                                                                           */
/* - Bug fix: Estimation of remaining runtime when fission source passing    */
/*            was used between depletion steps.                              */
/*                                                                           */
/* - NOTE: initdata.c:ssä kytkettiin DATA_STOP_AT_BOUNDARY pois päältä juuri */
/*         vähän ennen updaten jakelua                                       */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.26 (2016/04/21):                                              */
/*                                                                           */
/* - Changed PPW_POW_FRAC to PPW_POW in matlaboutput.c (for consistency with */
/*   .coe output).                                                           */
/*                                                                           */
/* - Added infinite rectangular prism in ADF calculation (note full symmetry */
/*   option)                                                                 */
/*                                                                           */
/* - Added option to include photon production (set ngamma), ei vielä        */
/*   lopullinen muoto.                                                       */
/*                                                                           */
/* - Added new poison cross sections (kumulatiiviset vs. independent tuotot) */
/*                                                                           */
/* - Added flux in fissile zones in matlaboutput.c                           */
/*                                                                           */
/* - Added command-line option (-nofatal) to ignore fatal errors             */
/*                                                                           */
/* - Added option to transfer source points from file (uses the sp entry)    */
/*                                                                           */
/* - Added micro-group calculation option in set micro (similar to set fum)  */
/*                                                                           */
/* - Added option to adjust normalization in coefficient calculation         */
/*                                                                           */
/* - Added binary file format in detector and source file (-1)               */
/*                                                                           */
/* - Changed the handling of user-specified response functions (added "fun"  */
/*   structure).                                                             */
/*                                                                           */
/* - Calculation of conversion ratio revised                                 */
/*                                                                           */
/* - Added option to adjust nuclide-wise fission energy deposition (similar  */
/*   to Serpent 1)                                                           */
/*                                                                           */
/* - Bug fix: PPW data in the default parameter list in coefoutput.c         */
/*                                                                           */
/* - Bug fix: -INFTY in equilibrium poison concentration.                    */
/*                                                                           */
/* - Bug fix: calculation of microscopic poison xs. NOTE: value must be      */
/*            divided bu fuel to total volume ratio (optional parameter in   */
/*            in poi card)                                                   */
/*                                                                           */
/* - Bug fix: all odd-N isotopes included in the calculation of conversion   */
/*            ratio.                                                         */
/*                                                                           */
/* - Bug fix: incorrect pointer (GCU_PTR_LAST_STAT) in processgc.c           */
/*                                                                           */
/* - Bug fix: energy grid boundary check in sabscattering.c                  */
/*                                                                           */
/* - Bug fix: MPI parallelization of MSR burnup routine.                     */
/*                                                                           */
/* - Bug fix: Material-wise cut-off in gamma decay source routine.           */
/*                                                                           */
/* - Bug fix: Photon heating xs multiplied by total.                         */
/*                                                                           */
/* - Bug fix: Geometry plotter combined with multi-material UMSH interface   */
/*                                                                           */
/* - Bug fix: Fuel behavior interface with rodnames containing letters       */
/*                                                                           */
/* - Bug fix: Several non-fatal fixes to transient simulations               */
/*                                                                           */
/* - Source code cleanup: removed Serpent 1 style gc generation, simulator   */
/*   and cax-output stuff.                                                   */
/*                                                                           */
/* - Print warning if the proportion of temperature majorant exceedings is   */
/*   high when using TMS or DBRC (printtmsdiagnostics.c)                     */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.27 (2016/09/23):                                              */
/*                                                                           */
/* - Bug fix: secondary photons with detector type -26                       */
/*                                                                           */
/* - Bug fix: photon dose rate detectors with tle type.                      */
/*                                                                           */
/* - Bug fix: Heating values in nuclides with S(a,b) data multiplied by      */
/*            cross sections several times.                                  */
/*                                                                           */
/* - Bug fix: Fixed division by zero problem in the calculation of TMS       */
/*            majorant boundaries                                            */
/*                                                                           */
/* - Bug fix: Divided materials excluded from majorant in optimization       */
/*            mode 1 if the first divided material is not part of geometry.  */
/*                                                                           */
/* - Bug fix: Isometric check in processtransformations.c                    */
/*                                                                           */
/* - Bug fix: U-235 capture missing in conversion ratio                      */
/*                                                                           */
/* - Bug fix: infinite loop if source file is empty                          */
/*                                                                           */
/* - Bug fix: corrector steps overwrite analog reaction rate files.          */
/*                                                                           */
/* - Bug fix: photon production data for some nuclides contains strange      */
/*            zeros (6012.03c @ JENDL-3.2) --> fixed by skipping data.       */
/*                                                                           */
/* - Bug fix: mesh detector boundaries not printed if size is 1.             */
/*                                                                           */
/* - Bug fix: missing continue in readrestartfile.c.                         */
/*                                                                           */
/* - Bug fix: source and detector cell check with STL geometries.            */
/*                                                                           */
/* - Bug fix: cell detectors at multiple geometry levels.                    */
/*                                                                           */
/* - Bug fix: removed nuclides skipped in burnmatcompositions.c              */
/*                                                                           */
/* - Bug fix: fixed geometry plots with fuel behavior interfaces             */
/*                                                                           */
/* - Bug fix: Several bugs related to scoring of KEFF estimators in dynamic  */
/*            simulations with delayed neutron emission                      */
/*                                                                           */
/* - Bug fix: bugs related to group structure of delayed neutrons in         */
/*            transient simulations                                          */
/*                                                                           */
/* - Bug fix: first update of a regular mesh based interface used to result  */
/*            in a "Material density exceeds material majorant..." error     */
/*                                                                           */
/* - Bug fix: Normalization of transient simulation with MPI parallelization */
/*                                                                           */
/* - Added option to label calculation as "confidential" (set confi)         */
/*                                                                           */
/* - Added option to set particle speed (set spd)                            */
/*                                                                           */
/* - Added photon production in total reaction rates (analog and implicit)   */
/*                                                                           */
/* - Added detector type -12 (analog photon heating)                         */
/*                                                                           */
/* - Added cumulative migration method (CMM) diffusion coefficients.         */
/*                                                                           */
/* - Added transport-correction with correction factors (set trc)            */
/*                                                                           */
/* - Added options to calculate homogeneous diffusion flux using CMM and TRC */
/*   diffusion coefficients                                                  */
/*                                                                           */
/* - Added option to exclude energy dependence of fission yields             */
/*   (set fissye)                                                            */
/*                                                                           */
/* - Added detector flagging (currently works only for collision and super-  */
/*   imposed types)                                                          */
/*                                                                           */
/* - Reworked coupled time-dependent calculation scheme                      */
/*                                                                           */
/* - Added possibility for time-interpolation for all interface types        */
/*                                                                           */
/* - Added a new interface type (regular mesh multiple materials, type 21)   */
/*                                                                           */
/* - Added velocity and acceleration based transformations for moving        */
/*   geometry                                                                */
/*                                                                           */
/* - Added a detector response function for particle leakage (-17)           */
/*                                                                           */
/* - Added multiple tries for file based communication in coupled calcs      */
/*                                                                           */
/* - Added input option to define fixed isomeric branching ratios            */
/*   (set isobra)                                                            */
/*                                                                           */
/* - Weight window mesh capability revised                                   */
/*                                                                           */
/* - Added a light-weight importance map solver (NOTE: muutit input          */
/*   formaattia viime tipassa rmtx --> wwgen, ym.)                           */
/*                                                                           */
/* - User-defined detector response functions from fun structure             */
/*                                                                           */
/* - Minimum XS for CFE changed to correspond to value set by user in        */
/*   "set minxs" (previously cut-off to minimum of majorant)                 */
/*                                                                           */
/* - Added option to treat undefined regions as void (set lost). Also the    */
/*   option to remove void cells was revised.                                */
/*                                                                           */
/* - Added option for photon energy cut-off (ecut)                           */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.28 (2017/02/06):                                              */
/*                                                                           */
/* - Bug fix: vfprintf() causing the program to crash when compiled in       */
/*            cygwin.                                                        */
/*                                                                           */
/* - Bug fix: print interval in criticality source mode                      */
/*                                                                           */
/* - Bug fix: multiplicity in transient mode (pointer error in tracking.c)   */
/*                                                                           */
/* - Bug fix: block size in precursor detector structure.                    */
/*                                                                           */
/* - Bug fix: exact treatment in sabscattering.c.                            */
/*                                                                           */
/* - Bug fix: dfl input routine.                                             */
/*                                                                           */
/* - Bug fix: Calculation of complex sqrt.                                   */
/*                                                                           */
/* - Bug fix: Check division by zero in hessfactorization.c.                 */
/*                                                                           */
/* - Bug fix: STOP_AT_BOUNDARY not set in all necessary conditions.          */
/*                                                                           */
/* - Bug fix: Change return variable of fgetc() from char to signed int      */
/*   in readtextfile.c, testdosfile.c. etc. This is to avoid infinite loop   */
/*   in some systems (IBM Blue Gene) which apparently fail the comparison    */
/*   with EOF.                                                               */
/*                                                                           */
/* - Bug fix: invalid index in sabscattering.c ("l0++"). Updated also        */
/*   sabscattering.c.                                                        */
/*                                                                           */
/* - Bug fix: Unstructured mesh based interfaces without temperature or      */
/*   density data were not working.                                          */
/*                                                                           */
/* - Bug fix: Coupled transient calculations failed with MPI parallelization */
/*   due to missing MPI guards in transportcycle.c.                          */
/*                                                                           */
/* - Added option to collect transmutation xs from burnup matrix into        */
/*   micro-depletion output                                                  */
/*                                                                           */
/* - Added option to apply transport correction to individual nuclides       */
/*                                                                           */
/* - Added option to calculate albedos for multiple universes                */
/*                                                                           */
/* - Added neutron energy cut-off: HUOM! input-arvojen järjestys!!!!!!       */
/*                                                                           */
/* - Added maximum running time (runtme)                                     */
/*                                                                           */
/* - "set minxs" chaned to "set cfe" (myös tuo minxs jätettiin optioksi,     */
/*   mutta korjaa kuvaus kuitenkin Wikiin).                                  */
/*                                                                           */
/* - Changed global output and error pointers to outp and errp.              */
/*                                                                           */
/* - Several minor corrections related to compilation using new options.     */
/*                                                                           */
/* - Revised handling of source files: source is not re-read if all points   */
/*   fit into buffer (size adjusted using "set sfbuf").                      */
/*                                                                           */
/* - New surface types added: box, mplane, rcc (MCNP-equivalent)             */
/*                                                                           */
/* - Added cell-specific search list (in addition to universe-specific)      */
/*   in FindUniverseCell().                                                  */
/*                                                                           */
/* - Added (hard coded) options to calculate volumes of cells and            */
/*   track-length estimator in MC volume calculation routine.                */
/*                                                                           */
/* - Added option to revers order of translations and rotations              */
/*   (NOTE: Default differs from MCNP).                                      */
/*                                                                           */
/* - Added separate ingestion and inhalation toxicities for fission products */
/*   and actinides.                                                          */
/*                                                                           */
/* - Optimized search mesh used with STL geometries (addsearchmesh.c)        */
/*                                                                           */
/* - New command line options: -mix and -spi                                 */
/*                                                                           */
/* - Changed Makefile to support FINIX 0.15.12.                              */
/*                                                                           */
/* - Added estimators for average energy of neutron causing fission (AFGE)   */
/*   and energy corresponding to average lethargy of neutron causing fission */
/*   (EALF).                                                                 */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.29 (2017/06/12):                                              */
/*                                                                           */
/* - Bug fix: Special treatment for alpha-decay of He-5 (readdecayfile.c).   */
/*                                                                           */
/* - Bug fix: Cumulative energy bins with spatial bins (processdetectors.c). */
/*                                                                           */
/* - Bug fix: equilibrium xenon concentrations in branch calculation.        */
/*            NOTE: the concentrations are written as zero in the output.    */
/*                                                                           */
/* - Bug fix: Loop over all reprocessors in MSR mode                         */
/*                                                                           */
/* - Bug fix: linking of energy-dependent fission yields in micro-depletion  */
/*            (linkreactions.c).                                             */
/*                                                                           */
/* - Bug fix: adding transformation order to angle form misinterpreted as    */
/*            a level transformation (readinput.c).                          */
/*                                                                           */
/* - Bug fix: pre-transformations only work with explicit type.              */
/*                                                                           */
/* - Bug fix: value checks for direction cosines in coordtrans.c             */
/*            (pretrans.c passes surface parameters as direction cosine)     */
/*            affects debug mode only.                                       */
/*                                                                           */
/* - Bug fix: ures boundaries for fission reactions set even if the material */
/*            has only fissile nuclides without ures probability table data  */
/*            (processreactionlists.c).                                      */
/*                                                                           */
/* - Bug fix: indexing in readrestartfile.c                                  */
/*                                                                           */
/* - Bug fix: constant mass flows in MSR burnup routine                      */
/*                                                                           */
/* - Included branch materials in .out output (last minute changes in        */
/*   checkcoefcalc.c line 129 and findmaterialpointers.c line 399).          */
/*                                                                           */
/* - Transposed the fission matrix (fissmtxoutput.c, kts. myös WW:n meili    */
/*   Serpent-kansiossa 3.5.2017).                                            */
/*                                                                           */
/* - Disallowed multiple library ID's in restart files because they may      */
/*   cause problems when the data is read (storecomposition.c).              */
/*                                                                           */
/* - Continuous spectra and neutron emission added in radioactive decay      */
/*   source mode.                                                            */
/*                                                                           */
/* - Coupled neutron / photon transport mode added.                          */
/*                                                                           */
/* - Response matrix solver and importance calculation completely revised.   */
/*                                                                           */
/* - Added number of photons produced in implicit mode (set ngamma).         */
/*                                                                           */
/* - Converted separate rotation matrices into a single matrix (readinput.c) */
/*                                                                           */
/* - Added activation detector (da-entry).                                   */
/*                                                                           */
/* - Added link to Serpent Wiki in error messages (NOTE: laita meilissä      */
/*   huomautus siitä että parametreille pitää määrittää ne anchorit)         */
/*                                                                           */
/* - Added MT 18 in micro depletion as sum of 19-21 + 38.                    */
/*                                                                           */
/* - TODO: lisää fp, act, jne. inventorylist.c:hen ja päivitä kuvaus wikiin. */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.30 (2018/02/14):                                              */
/*                                                                           */
/* - Bug fix: Doppler temperature not reset in branch calculation            */
/*            (invokebranch.c).                                              */
/*                                                                           */
/* - Bug fix: Incorrect multiplier for memory allocation in function         */
/*            allocprivatedata.c (memory size proportional to number of      */
/*            threads squared).                                              */
/*                                                                           */
/* - Bug fix: Parse error in endfcolf.c                                      */
/*                                                                           */
/* - Bug fix: incorrect compiler flag checked when compiled withoug LibGD    */
/*            (printtitle.c)                                                 */
/*                                                                           */
/* - Bug fix: incorrecct pointer for divided tet-cells (ifcpoint.c)          */
/*                                                                           */
/* - Bug fix: incorrect material pointers (processinterface.c)               */
/*                                                                           */
/* - Bug fix: Some dosimetry reactions incorrectly labeled (reactionmt.c)    */
/*                                                                           */
/* - Bug fix: Detector output not printed for SIE corrector steps            */
/*            (detectoroutput.c)                                             */
/*                                                                           */
/* - Bug fix: CMM calculation if boundary surface is not centered to origin  */
/*            (boundaryconditions.c)                                         */
/*                                                                           */
/* - Bug fix: Value check in readacefile.c (TYR)                             */
/*                                                                           */
/* - Bug fix: Zeros in MCNP format weight window mesh (readwwdmesh.c)        */
/*                                                                           */
/* - Bug fix: Temperature round-off in overrideids.c                         */
/*                                                                           */
/* - Bug fix: Zero values in top x inventory lists (refreshinventory.c)      */
/*                                                                           */
/* - Bug fix: Call to RefreshInventory() moved from printdepoutput.c to      */
/*            burnupcycle.c (inventory not refreshed in decay calculation)   */
/*                                                                           */
/* - Bug fix: Calculation terminated by zero SF nubar data in JEF-2.2        */
/*            (processdecaydata.c)                                           */
/*                                                                           */
/* - Bug fix: material densities incorrectly set in branch calculation       */
/*            (readrestartfile.c).                                           */
/*                                                                           */
/* - Bug fix: rotation angle inverted in rotations around arbitrary vectors  */
/*            (coordtrans.c).                                                */
/*                                                                           */
/* - Bug fix: Wrong burnup point found in index search (readrestartfile.c).  */
/*            NOTE: sisäisesti toi käsitellään siten että readinput.c:ssä    */
/*            indeksiin lisätään 1, ja idx = 1 vastaa nollapalamaa (input-   */
/*            arvoa 0). Tota ei oo kuvattu Wikissä.                          */
/*                                                                           */
/* - Bug fix: Zero burnup compositions not read from restart file in branch  */
/*            calculation, which affects equilibrium poison concentrations   */
/*            (coefcycle.c).                                                 */
/*                                                                           */
/* - Bug fix: Skip photon interaction data for elements Z > 99               */
/*            (readacedata.c, readphotondata.c)                              */
/*                                                                           */
/* - Bug fix: MPI id not set for secondary photons (photonprod.c).           */
/*                                                                           */
/* - Bug fix: No error message from undefined universe (invokebranch.c)      */
/*                                                                           */
/* - Bug fix: negative electron energy causes infinite loop in               */
/*            pairproduction.c.                                              */
/*                                                                           */
/* - Bug fix: Comment line in MCNP wwinp files (readwwmesh.c)                */
/*                                                                           */
/* - Bug fix: Color palette was set incorrectly in geometry plots with       */
/*            interface in material with depletion zone division.            */
/*                                                                           */
/* - Bug fix: Delayed fission spectrum sensitivities were calculated         */
/*            incorrectly.                                                   */
/*                                                                           */
/* - Bug fix: Coupled neutron-photon transport and TMS crashed completely.   */
/*            Note: Some things might still be broken.                       */
/*                                                                           */
/* - Bug fix: OpenFOAM interface without density file and a negative nominal */
/*            density terminated in a processing error after first iteration */
/*                                                                           */
/* - Bug fix: Interfaces for materials with depletion zone division:         */
/*            The interface is now linked simply based on name and copied to */
/*            divided materials if (and only if) the parent has an interface */
/*            linked.                                                        */
/*                                                                           */
/* - Bug fix: Weight conservation check in resizefissionsrc.c.               */
/*                                                                           */
/* - Bug fix: Material density factor was set to 0 outside of unstructured   */
/*            mesh, if OpenFOAM interface was linked. Now set to 1.          */
/*                                                                           */
/* - Bug fix: Doppler preprocessor is now set on for interface materials     */
/*            that are in constant temperature.                              */
/*                                                                           */
/* - Bug fix: In coupled calculations with MPI parallelization, SIGUSR2 was  */
/*            not correctly passed to other tasks if received by task 0.     */
/*                                                                           */
/* - Bug fix: Calculation of convergence criteria for OpenFOAM interface     */
/*            density fields.                                                */
/*                                                                           */
/* - Bug fix: Coupled transient simulations with a single time-interval      */
/*            were unable to save the end-of-simulation source distributions */
/*                                                                           */
/* - Bug fix: Interaction time for non-fuel-behavior interfaces was read     */
/*            from the wrong universe.                                       */
/*                                                                           */
/* - Bug fix: Detector type "dt 4" (multiply with local temperature) could   */
/*            not be used due to value check at readinput.c.                 */
/*                                                                           */
/* - Bug fix: History output <input>_his.m was broken with fission source    */
/*            passing "set fsp".                                             */
/*                                                                           */
/* - Bug fix: Last reaction mode was not calculated to total XS sensitivity. */
/*                                                                           */
/* - Bug fix: Critical atomic density iteration crashed when used with       */
/*            material list.                                                 */
/*                                                                           */
/* - Bug fix: Critical atomic density iteration complained of zero-density   */
/*            nuclides when used for mixtures of two materials both of which */
/*            contained the iterable nuclide.                                */
/*                                                                           */
/* - Bug fix: Output interval is now automatically set to 1 time interval in */
/*            coupled transient simulations.                                 */
/*                                                                           */
/* - Bug fix: In rare cases, a separate nuclide was not added for TMS-       */
/*            treated materials if a TMP-treated material already contained  */
/*            that nuclide and Doppler temperature equalled library temp.    */
/*                                                                           */
/* - Bug fix: Xenon iteration in multi-group majorant mode.                  */
/*                                                                           */
/* - Added a multiplier to change normalization in branch calculations       */
/*   ("norm").                                                               */
/*                                                                           */
/* - Added options to reset poison concentrations in branch calculations     */
/*   ("xenon" and "samarium")                                                */
/*                                                                           */
/* - Implemented double-indexing (invoked by "set dix 1", not on by default. */
/*                                                                           */
/* - Added option to switch CMM calculation on or off (set cmm). This is     */
/*   because the calculation time scales badly with the number of energy     */
/*   groups. The option only allows 0/1, and 1 is the default implicit       */
/*   mode also set in initdata.c.                                            */
/*                                                                           */
/* - Added support for non-uniformly spaced reactangular weight window mesh. */
/*                                                                           */
/* - Added two new detector mesh types (dn 3/-3 and dn 4/-4).                */
/*                                                                           */
/* - Added a sanity check in processinventory.c.                             */
/*                                                                           */
/* - Added option to decompose elemental definitions in the input            */
/*   (set decomp).                                                           */
/*                                                                           */
/* - Added a warning message if decay source is used in neutron transport    */
/*   mode and actinides are missing neutron emission spectra for             */
/*   spontaneous fission.                                                    */
/*                                                                           */
/* - Added option to start from n:th batch or history in external source     */
/*   simulation mode (useful for debugging). Option included in "set seed".  */
/*                                                                           */
/* - Added -noplot and -norun command line options.                          */
/*                                                                           */
/* - Output of volume checker routine beautified (volumesmc.c)               */
/*                                                                           */
/* - Unused mixtures included when decomposed with -mix command line option. */
/*                                                                           */
/* - Implemented surface flux detector (works for a limited number of        */
/*   surface types). NOTE: muista selittää että toi integroi pinta-alan      */
/*   yli kun muut integroi tilavuuden yli.                                   */
/*                                                                           */
/* - Added an additional scaling factor for fission nubar (set keff)         */
/*                                                                           */
/* - Implemented a new symmetry option.                                      */
/*                                                                           */
/* - Handling of weight windows mesh in source routine modified. Weight      */
/*   cut-off is now applied in a rejection loop. The number of started       */
/*   particles is preserved. (muista myös wn-parametrin muutokset wikiin)    */
/*                                                                           */
/* - Added new options in "set ngamma".                                      */
/*                                                                           */
/* - Added option to limit number of splits (set maxsplit)                   */
/*                                                                           */
/* - Added a quick search option to link surfaces to cells using the numeric */
/*   values of surface names (processcells.c).                               */
/*                                                                           */
/* - Added calculation of parameters in the six-factor formula.              */
/*   NOTE: Noista termeistä näyttäisi olevan useampaa eri määritelmää,       */
/*   selitä jokainen termi Wikissä.                                          */
/*                                                                           */
/* - Added option to sum over cell and material bins (dt -4)                 */
/*                                                                           */
/* - Added macroscopic light nuclide production reactions (MT's -53 to -57)  */
/*                                                                           */
/* - Added a check for number of normalizations (setoptimization.c).         */
/*                                                                           */
/* - Added check for incompatile source types in multi-particle simulations  */
/*   (processources.c).                                                      */
/*                                                                           */
/* - Added an error message on negative densities that may occur with        */
/*   constant reprocessing flows (burnmaterials.c)                           */
/*                                                                           */
/* - Changed how memory is allocated for particles in external source mode   */
/*   (not dependent on batch size).                                          */
/*                                                                           */
/* - Changed the way minimum stack size is calculated.                       */
/*                                                                           */
/* - Changed rotations around a general axis to use the correct signs for    */
/*   the angles.                                                             */
/*                                                                           */
/* - Custom perturbations (XGPT and the like) can now be set for Legendre    */
/*   moments, nubar and fission spectrum.                                    */
/*                                                                           */
/* - Re-wrote the internal structures for unstructured meshes in order to    */
/*   save memory and allow for meshes with more cells.                       */
/*                                                                           */
/* - Unified the processing of unstructerd mesh based geometries and IFCs.   */
/*                                                                           */
/* - Added special handling for interface output with OpenFOAM interfaces    */
/*   with symmetry-type patches.                                             */
/*                                                                           */
/* - Added a step number to the sensitivity output file name.                */
/*                                                                           */
/* - Added capability to put -1 as materials file for ifc type 9 (solid 3)   */
/*   followed by material name, if the whole geometry consists of a single   */
/*   material.                                                               */
/*                                                                           */
/* - Added the possibility to print out absolute or relative estimates of    */
/*   statistical uncertainties for OpenFOAM interface output as a separate   */
/*   field.                                                                  */
/*                                                                           */
/* - Added a printout for mesh and point-based interfaces for exceeding TMS- */
/*   limits in ifcpoint.c.                                                   */
/*                                                                           */
/* - Removed complex reactions from being lumped into captures in            */
/*   sensitivity calculations.                                               */
/*                                                                           */
/* - Added option for OpenFOAM mesh based interface to tally fission power   */
/*   from all materials that are covered by the mesh instead of simply the   */
/*   interface material.                                                     */
/*                                                                           */
/* - Added option to explicitly give list of sum reaction modes to include   */
/*   in sensitivity calculations instead of simply "sens pert xs all".       */
/*                                                                           */
/* - Added option to only include some MTs as perturbations in sensitivity   */
/*   calculations.                                                           */
/*                                                                           */
/* - Added an input card to sample the temperature and density fields on a   */
/*   cartesian mesh after all interfaces etc. have been processed. Intended  */
/*   for verifying/debugging interfaces.                                     */
/*                                                                           */
/* - Implemented new interpolation and extrapolation scheme for Compton      */
/*   profiles and updated the sampling method accordingly.                   */
/*                                                                           */
/* - Implemented new sampling method for the direction of photoelectrons.    */
/*   The exact Sauter distribution is used for all energies instead of the   */
/*   low-energy approximation used previously.                               */
/*                                                                           */
/* - Replaced photoelectric cross section data files xspess.dat and          */
/*   xspetot.dat with xspe.dat. The same ENDF/B-VII.1 data is still used.    */
/*                                                                           */
/* - Removed the obsolete electron stopping power data file                  */
/*   el_stopping_power.dat                                                   */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.31 (2019/05/16):                                              */
/*                                                                           */
/* - Implemented domain decomposition                                        */
/*                                                                           */
/* - Changed the initialization of microxs reconstruction when DIX is on     */
/*   (wikissä sanotaan että voi käyttää vain moodeissa 1 ja 3).              */
/*                                                                           */
/* - Changed initialization of default random number seed to account for     */
/*   time in milliseconds (initdata.c).                                      */
/*                                                                           */
/* - Added option to randomize decay constants and fission yields            */
/*   (set rnddec).                                                           */
/*                                                                           */
/* - Added total capture in micro depletion (MT 101)                         */
/*                                                                           */
/* - Added calculation of Eddington factors (by A. Ward).                    */
/*                                                                           */
/* - Added sign moments for discontinuity factors.                           */
/*                                                                           */
/* - Added command line option to select MC volume calculation algorithm.    */
/*                                                                           */
/* - Added new surface types: hexxap, hexyap.                                */
/*                                                                           */
/* - Added srad option in source sampling (samplesrcpoint.c).                */
/*                                                                           */
/* - Changed the syntax of src/sb (sampletabular.c).                         */
/*                                                                           */
/* - Added a minimum and maximum limits for importances and a smoothing      */
/*   algorithm for weight-window meshes (wwin/wt-option).                    */
/*                                                                           */
/* - Added geometry importances (set imp).                                   */
/*                                                                           */
/* - Changed the syntax of wwin-card (wf:n optiot erotettu wt:hen).          */
/*                                                                           */
/* - Added support for response functions for surface flux detector          */
/*   (superdet.c).                                                           */
/*                                                                           */
/* - Added command line option -input to copy inputs in file                 */
/*   (parsecommandline.c)                                                    */
/*                                                                           */
/* - Added support for hexagonal mesh in sca.                                */
/*                                                                           */
/* - Added input parameter to set weight window boundary factors (set wwb).  */
/*                                                                           */
/* - Added two detector type flags (-5 = importance weighting, -6 = sum over */
/*   number of scores).                                                      */
/*                                                                           */
/* - Added fission products, decay products and noble gases in inventory     */
/*   list and support for Serpent 1 style "act" entry for actinides.         */
/*   (processinventory.c).                                                   */
/*                                                                           */
/* - New formula to calculate estimated running time in external source      */
/*   mode (estimateruntime.c). NOTE: jos toimii niin tätä voisi käyttää      */
/*   muissakin moodeissa.                                                    */
/*                                                                           */
/* - Added cell neighbour search list (finduniversecell.c). HUOM: tää ei     */
/*   ei toimi oikein monestakaan syystä, pääasiassa siksi että rutiini       */
/*   luuppaa joka tapauksessa kaikki tasot läpi siihen asti että radan       */
/*   katkaissut universumi löytyy. Toi myös antaa vääriä osumia ainakin      */
/*   ITER CSG -geometriassa. Disabloitu toistaiseksi.                        */
/*                                                                           */
/* - Added separate variable for testing previous source cell                */
/*   (finduniversecell.c)                                                    */
/*                                                                           */
/* - Added OpenMP parallelization for cell search lists (sortall.c)          */
/*                                                                           */
/* - Added a warning if outside cells are used at higher levels.             */
/*                                                                           */
/* - Added option to treat Xe135m separately in poison xs calculation        */
/*   (set poi).                                                              */
/*                                                                           */
/* - Implemented hex meshes in importance solver.                            */
/*                                                                           */
/* - Added an error check on proper batch size in processgc.c                */
/*                                                                           */
/* - Added option to set RES2 array private/shared (set shbuf)               */
/*                                                                           */
/* - Added option to print universe, cell and material names at given        */
/*   given points (matpos.c). Muista lisätä kuvaus wikiin.                   */
/*                                                                           */
/* - Added option to generate group constants in virtual universes           */
/*   (virtgcucolflags.c).                                                    */
/*                                                                           */
/* - Added new energy deposition modes presented in                          */
/*   https://doi.org/10.1016/j.anucene.2019.02.003                           */
/*                                                                           */
/* - Added new detector response (-80) for calculating the total energy      */
/*   deposition                                                              */
/*                                                                           */
/* - Added a more helpful error message for transient simulations, where the */
/*   precursor group structures between transient simulation and pre-        */
/*   generated source files is different.                                    */
/*                                                                           */
/* - Added a more helpful error message for violation of material            */
/*   temperature TMS-limits.                                                 */
/*                                                                           */
/* - Added the possibility to set the number of OpenMP threads to use in     */
/*   the simulation via the OMP_NUM_THREADS or SERPENT_OMP_NUM_THREADS       */
/*   environment variable (latter overrides the former).                     */
/*                                                                           */
/* - Added SCALE 56 and 252 group energy group structures.                   */
/*                                                                           */
/* - Added the option to define a scaling factor for fission neutron and     */
/*   precursor production ("k-eff") that can be used to make non-critical    */
/*   system critical in the beginning of the transient simulation.           */
/*                                                                           */
/* - Added the possibility to use more continuous time-dependent             */
/*   geometry transformations in transient modelling.                        */
/*                                                                           */
/* - Added function expansion detectors and intefaces based on PhD thesis    */
/*   work of Brycen Wendt.                                                   */
/*                                                                           */
/* - Added support for general data meshes (as input cards) and data         */
/*   interfaces for atomic densities.                                        */
/*                                                                           */
/* - Added the option of scoring reaction rate ratio (detector ratio)        */
/*   sensitivities more seldom for faster runtime but worse statistics.      */
/*                                                                           */
/* - Added support for multi-bin detectors in reactio rate ratio (detector   */
/*   ratio) sensitivities. The number of bins must match between the         */
/*   detectors.                                                              */
/*                                                                           */
/* - Added uncertainty propagation capabilities based on reading in          */
/*   cross section data covariance matrices in the COVERX-format of SCALE    */
/*   (binary or ASCII) and collapsing the calculated sensitivity vectors     */
/*   with the covariance matrices (applying the sandwich rule) during runtime*/
/*                                                                           */
/* - Added support for sensitivity calculations for surface current/flux     */
/*   detectors or their ratios.                                              */
/*                                                                           */
/* - Optimized the collection of sensitivity results.                        */
/*                                                                           */
/* - Added a socket-based communicator for coupled calculations with the new */
/*   Kraken-framework.                                                       */
/*                                                                           */
/* - Re-worked some of the routines handling the multi-physics interfaces.   */
/*                                                                           */
/* - Added support for multi-level regular mesh interfaces (type 22).        */
/*                                                                           */
/* - Added the possibility to score power on the input mesh in multi-        */
/*   physics interface types 2 and 22.                                       */
/*                                                                           */
/* - Bug fix: Meulekamp beta-eff with multiple GCU's (scoregcu.c)            */
/*                                                                           */
/* - Bug fix: RNG initialization in dynamic mode (normalizedynsrc.c)         */
/*                                                                           */
/* - Bug fix: Calculation of particle balance in dynamic mode (timecutoff.c) */
/*                                                                           */
/* - Bug fix: Memory allocation in dynamic mode (normalizedynsrc.c).         */
/*                                                                           */
/* - Bug fix: Extra energy group in micro depletion variables.               */
/*                                                                           */
/* - Bug fix: Mesh binning with tle detectors.                               */
/*                                                                           */
/* - Bug fix: material densities read from restart files that start from     */
/*            nonzero burnup (readrestertfile.c, invokebranch.c)             */
/*                                                                           */
/* - Bug fix: Decay nuclides read multiple times when "fix" entry is         */
/*            included in multiple material cards. (processnuclides.c)       */
/*                                                                           */
/* - Bug fix: Z-boundaries in cylindrical detector output.                   */
/*                                                                           */
/* - Bug fix: Numeric conversion of surface names starting with zero.        */
/*            (numericstr.c)                                                 */
/*                                                                           */
/* - Bug fix: Used-flags not properly set in mixtures of mixtures.           */
/*            (findmaterialpointer.c)                                        */
/*                                                                           */
/* - Bug fix: Fixed previous cleanup in processinventory.c                   */
/*                                                                           */
/* - Bug fix: Handling of nitrogen in zaitoiso.c                             */
/*                                                                           */
/* - Bug fix: Search mesh counter types (addsearchmesh.c)                    */
/*                                                                           */
/* - Bug fix: Uninitialized variable (Npz) in processcompton.c               */
/*                                                                           */
/* - Bug fix: Negative atomic densities when restart file is read and        */
/*            material density is given in atomic units (readrestartfile.c)  */
/*                                                                           */
/* - Bug fix: He-4 without (n,gamma) xs caused pointer error in reaction     */
/*            sampling when implicit capture was used (samplereaction.c).    */
/*                                                                           */
/* - Bug fix: Detector type 4 (dt 4) was not accepted as valid               */
/*            input due to a bug.                                            */
/*                                                                           */
/* - Bug fix: Detector output, where axial distributions from certain        */
/*            detectors were not printed correctly (the same information     */
/*            was printed for each axial level).                             */
/*                                                                           */
/* - Bug fix: The number of original UMSH cells was no more copied from the  */
/*            IFC block since 2.1.30. The value is used in a value check     */
/*            in processdetectors with "dumsh" detectors.                    */
/*                                                                           */
/* - Bug fix: Acceleration based transformations kept going after            */
/*           end of specified time.                                          */
/*                                                                           */
/* - Bug fix: The minimum particle stack size was never reset leading to     */
/*            more stack size being allocated each batch after the stacks    */
/*            were low for the first time leading to a runaway increase in   */
/*            memory consumption.                                            */
/*                                                                           */
/* - Bug fix: Some problems with OpenFOAM interface:                         */
/*            Couldn't be updated. Patches were wrong.                       */
/*                                                                           */
/* - Bug fix: Calculation of convergence criteria in relaxinterfacepower.c.  */
/*                                                                           */
/* - Bug fix: Calculation of density field convergence in OpenFOAM mesh      */
/*            based interfaces.                                              */
/*                                                                           */
/* - Bug fix: Serpent would send an additional SIGUSR2 signal in coupled     */
/*            burnup calculations.                                           */
/*                                                                           */
/* - Bug fix: Limits check for sample-card was conducted incorrectly.        */
/*                                                                           */
/* - Bug fix: Sensitivity output: the energy integrated output data were     */
/*            written with the same name as the non-integrated ones.         */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Serpent 2.1.32 (2020/??/??):                                              */
/*                                                                           */
/* - Bug fix: Last value not printed in printhistoryoutput.c.                */
/*                                                                           */
/* - Bug fix: Indexing error in histogram sampling in sampletabular.c        */
/*            (may affect continuous radiation decay source spectra).        */
/*                                                                           */
/* - Bug fix: Treatment of erroneous zero cumulative fission yields          */
/*            (readfissionyields.c, processfissionyields.c).                 */
/*                                                                           */
/* - Bug fix: Zero sum and search fail in readrestartfile.c                  */
/*                                                                           */
/* - Bug fix: Errors in domain decomposition (trackmode.c,                   */
/*            calculatetransmuxs.c).                                         */
/*                                                                           */
/* - Bug fix: Calculation total fission transmutation xs when nfy data is    */
/*            not provided (calculatetransmuxs.c). NOTE: iso virhe (dataa    */
/*            ei resetoida silmukassa nuklidien yli), mutta ei suurta        */
/*            vaikutusta koska tulokset joka tapauksessa väärin jos          */
/*            fissiotuotteet eivät ole mukana laskussa.                      */
/*                                                                           */
/* - Bug fix: Negative ures boundaries in natural elements (40000) caused    */
/*            some TMS routines to be skipped (dopmicroxs.c, potcorr.c).     */
/*                                                                           */
/* - Bug fix: tracks not stopped at repetetive boundaries when wwgen or wwin */
/*            is on (setoptimization.c)                                      */
/*                                                                           */
/* - Bug fix: readacefile.c fails to skip nuclides in some ace files         */
/*            (e.g. sab2002).                                                */
/*                                                                           */
/* - Bug fix: Previous photon macroxs stored with StoreValuePair() caused    */
/*            problems with np simulations in burnup mode (atomic densities  */
/*            changed but xs stored during previous step used). Fixed the    */
/*            by adding a new routine ClearValuePairs() that resets all      */
/*            temporary data before running transport. This should also      */
/*            enable storing macro xs for neutron calculations.              */
/*                                                                           */
/* - Buf fix: Depletion zone indexing in set mvol may be off if there are    */
/*            unused burnable materials in nests. Not fixed, but added a     */
/*            warning in checkunused.                                        */
/*                                                                           */
/* - Bug fix: False surface crossings scored in surface flux detector        */
/*            routine (superdet.c).                                          */
/*                                                                           */
/* - Bug fix: Spontaneous fission not linked to lost if yield is not         */
/*            provided (linkreations.c).                                     */
/*                                                                           */
/* - Bug fix: Ta-180 in natural tantalum is actually Ta-180m. Special        */
/*            treatment added in element.c and stdcomp.c.                    */
/*                                                                           */
/* - Bug fix: LIST_COMMON_PTR_LAST not set if last item is duplicated        */
/*            (duplicateitem.c).                                             */
/*                                                                           */
/* - Bug fix: memory allocation for photon histories in coupled n/p mode     */
/*            inithistories.c.                                               */
/*                                                                           */
/* - Bug fix: Order of MICRO_E array in _res.m output (matlaboutput.c).      */
/*                                                                           */
/* - Bug fix: ADF universes not linked to super-imposed universes            */
/*            (creategeometry.c).                                            */
/*                                                                           */
/* - Bug fix: Double-indexing used for dosimetry data (processdix.c)         */
/*                                                                           */
/* - Bug fix: Parameters for implicit photon production not properly         */
/*            initialized (initdata.c).                                      */
/*                                                                           */
/* - Bug fix: DBRC nuclides included in pocessphotonprod.c                   */
/*                                                                           */
/* - Bug fix: Mixture volumes read to wrong variable (readinput.c)           */
/*                                                                           */
/* - Added a burnup-dependent transformation type (transb)                   */
/*                                                                           */
/* - Added a few consistency checks in processstlgeometry.c                  */
/*                                                                           */
/* - New option in depoutput (2 == no depletion output).                     */
/*                                                                           */
/* - Cells defined without surfaces are treated as infinite.                 */
/*                                                                           */
/* - Added option to write secondary photons to file "set gsw".              */
/*                                                                           */
/* - Changed criticality source and secondary file format to binary.         */
/*                                                                           */
/* - Implemented filled STL solids.                                          */
/*                                                                           */
/* - Added nubars and kappa in micro depletion: MT's 452, 455, 456, 458      */
/*   (linkreactions.c, scoremicrodep.c).                                     */
/*                                                                           */
/* - Added distance calculation to sub-zones (divsubdistance.c). NOTE:       */
/*   this is only used by the volume calculation routine.                    */
/*                                                                           */
/* - Added support for continuous distributions in bound inelastic           */
/*   scattering.                                                             */
/*                                                                           */
/* - Added equilateral triangular prism (tric).                              */
/*                                                                           */
/* - Added pre-transformation of cylx, cyly, cylz.                           */
/*                                                                           */
/* - Added normal vectors for cylv and rcc.                                  */
/*                                                                           */
/* - Added micro-depletion data in coefficient output.                       */
/*                                                                           */
/* - Mirco-depletion stuff re-written (update description in Wiki).          */
/*                                                                           */
/* - Changed output pointer in error.c from outp to errp to prevent error    */
/*   messages from MPI tasks going to /dev/null.                             */
/*                                                                           */
/* - Extended detector lattice bins to pbed type.                            */
/*                                                                           */
/* - Added option to use mesh and cell detectors with a single bin with      */
/*   surface detectors (superdet.c).                                         */
/*                                                                           */
/* - Implemented detector mesh transformation (dtrans or trans d)            */
/*                                                                           */
/* - Implemented lattice transformation (ltrans or trans l)                  */
/*                                                                           */
/* - Implemented energy-dependent importances (eneimp.c)                     */
/*                                                                           */
/* - Added option -1 to "set bala" to enforce common que for all particles,  */
/*   > 0 values operate on multiplicity. (toque.c, fromque.c).               */
/*                                                                           */
/* - All transport nuclides in fission product distribution peaks now        */
/*   included in calculation (combinefissionyields.).                        */
/*                                                                           */
/* - Added a check for multi-level super-imposed universes                   */
/*   (creategeometry.c)                                                      */
/*                                                                           */
/* - Added option to read and write STL search mesh in file (set stlfile)    */
/*                                                                           */
/* - Added albedo leak rate in neutron balance (boundaryconditions.c,        */
/*   tracking.c).                                                            */
/*                                                                           */
/* - Added NSEW symmetry option in ADF calculation. (applygcsymmetries.c)    */
/*                                                                           */
/* - Added calculation of FIMA (calculatemasses.c)                           */
/*                                                                           */
/* - Optimized material search when mvol card is used (materialvolumes.c).   */
/*                                                                           */
/* - HUOM: TTA feilaa joissain tilanteissa missä menetelmään vaihdetaan kun  */
/*         vuo on pieni (Max length of TTA chain exceeded). kts. Vince       */
/*         Wangin meili 15.6.2018.                                           */
/*                                                                           */
/* - HUOM: rotaatiotransformaation geneerisessä muodossa ehkä joku häikkä.   */
/*         (katso Vincenzo Romanellon meili 24.3. Serpent-kansiossa).        */
/*                                                                           */
/* - HUOM: Weight window meshin reuna ei saa yhtyä geometrian reunaan        */
/*         (tracking-rutiini jää jotenkin jumiin)                            */
/*                                                                           */
/* - HUOM: Uusi tapa laskea etäisyys STL-pintoihin (neareststlboundary.c)    */
/*         --> toi pitää validoida ja testata tehokkuus (Giacint & Octamak). */
/*                                                                           */
/* - HUOM: Importance solverin hexahila toimii vain jos keskipiste on        */
/*         origossa (antaa joskus errorin nearstboundary.c:ssä).             */
/*                                                                           */
/* - Photon source rate näyttää nollaa .out filessa                          */
/*                                                                           */
/* - TODO: Yhdenmukaista noi search mesh countterit (kaikista pois se        */
/*         privamuuttujahässäkkä).                                           */
/*                                                                           */
/* - HUOM: Noi source filet ja wwgen voi aiheuttaa erroreita jos lähde-      */
/*         pisteet osuu hilan reunalle (boundary not crossed). Ratkaisu      */
/*         voisi olla poikkeuttaa lähdepistettä pienellä satunnais-         .*/
/*         vektorilla.                                                       */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* - Track plotter toimii kummallisesti delta-tracking -moodissa jos         */
/*   geometria koostuu kokonaan lähes voidista (tiheys ~1E-22). Voi olla     */
/*   että vaikuttaa myös fysiikkaan.                                         */
/*                                                                           */
/* - GridSearch() -ongelma (Diego Ferraron meili 6.8.2014)                   */
/*                                                                           */
/* - MT 11 (n,2nd) on jäänyt jostain syystä pois (harvinainen, mutta mukana  */
/*   esim. TENDL 2014 -kirjastossa. Tosi monessa paikassa on oletettu että   */
/*   MT 16 on ensimmäinen osareaktio. Korjataan ennen seuraavaa päivitystä.  */
/*                                                                           */
/* - Dokumentoi user-defined desponse functio (dr -100) (Selvitä sen         */
/*   histogram-tyyppisen funktion rajat, eli onko piste ylä vai alaraja)     */
/*                                                                           */
/* - Korjaa se pbed-geometrioiden yli looppaus makedepletionzones.c:ssä      */
/*   (joku flägi joka ilmoittaa onko aliuniversumeita, tms.)                 */
/*                                                                           */
/* - Se S(a,b) datan energygridiin versiossa 2.1.20 lisätty piste aiheuttaa  */
/*   jonkun fatal errorin sabscattering.c:ssä (mu < -1.0, CG:n testikeissi   */
/*   27.4.2014)                                                              */
/*                                                                           */
/*   HUOM: Noiden muiden interfacejen outputtien toiminta pitää testata.     */
/*                                                                           */
/* - Palama ja/tai prosessointiluuppi hidastuu merkittävästi jos OpenMP:llä  */
/*   ajetaan enemmän threadeja kuin koneessa on (vapaita) ytimiä.            */
/*                                                                           */
/* - Mixturejen käsittely menee vituiks jos järjestys on väärä (uusimmat     */
/*   BEAVRS -testikeissit) (WTF on uusimmat??)                               */
/*                                                                           */
/* - ScorePinPower():ssa ei luupata kaikkien structureiden yli.              */
/*                                                                           */
/* - Lisää mahdollisuus normeerata universumiin (Volker Hannsteinin) meili   */
/*   8.11.2013.                                                              */
/*                                                                           */
/* - TODO: ryhmävakioiden generointiin optio generoida mikroskooppisia       */
/*         vaikutusaloja käyttäjän antaman nuklidi- ja reaktiolistan mukaan. */
/*                                                                           */
/* - Tilastollisten testien kuvaus sitten kun outputti on siivottu.          */
/*                                                                           */
/* - TODO: calcmicroxs.c:ssä luuppi sirontamatriisien yli pitäisi nopeutua   */
/*         jos for-lausekkeet kääntää toisin päin ja muuttaa if-rakennetta   */
/*         tota voisi koittaa myös rinnakkaistaa (iso pullonkaula jos        */
/*         ryhmiä on paljon). microcalc.c:hen voi lisätä testejä             */
/*         nollavuolle.                                                      */
/*                                                                           */
/* - TODO: kato ne movest.c:n jutut vielä kuntoon (liittyy VVER440 -laskuun) */
/*                                                                           */
/* - HUOM: ures sampling implicit capture moodissa laskee väärin sumabsxsn!! */
/*         (järkevöitä varoitusmessagea processuresdata.c:ssä)               */
/*                                                                           */
/* - huomauta updaten jaon yhteydessä tosta "re-entrant" virheilmoituksesta  */
/*   päivitetyssä stopatboundary.c:ssä.                                      */
/*                                                                           */
/* - Nimeä gcross baffleksi ja dokumentoi                                    */
/*                                                                           */
/* - 25055.82c MCNP6-kirjastoissa                                            */
/*                                                                           */
/* - Se pistejuttu latticessa ei toimi div sep -jutun kanssa.                */
/*                                                                           */
/* - Tossa mt 5 -hommassa on vielä joku bugi, eikä se toimi ainakaan jeff311 */
/*                                                                           */
/* - MT5:n multiplikaatio makrovaikutusaloihin                               */
/*                                                                           */
/* - Makrovaikutusalojen laskenta jumittaa pahasti uudessa klusterissa       */
/*   (FW:n VVER-1000 nippupalamalasku)                                       */
/*                                                                           */
/* - B1-laskun epäonnistuminen on hoidettu epämääräisellä viritelmällä,      */
/*   jossa käytetään kahta eri muuttujaa ja tapauskohtaisesti joko jätetään  */
/*   tulokset tallentamatta tai sitten käytetään inf-spektriä. Myös b1flux.c */
/*   on koodattu tökerösti.                                                  */
/*                                                                           */
/* - Directory file toimii epäloogisesti jos kahdella eri tiedostoon         */
/*   viittaavalla nuklidilla on sama nimi (luetaan ensimmäinen riippumatta   */
/*   siitä mikä alias on)                                                    */
/*                                                                           */
/* - Source point -animaatio on ehkä kokonaan dokumentoimatta?               */
/*                                                                           */
/* - Reproducible MPI -moodi ei toimi (häikkää rendezvous.c -rutiinin        */
/*   vanhoissa historiamuuttujissa).                                         */
/*                                                                           */
/* - Uusissa MCNP6-kirjastoissa on CE S(a,b) formaatti jota ei tueta         */
/*                                                                           */
/* - TODO: 1/v -absorberi                                                    */
/*                                                                           */
/* - TODO: poista "comp" -optio ja readmaterialcompositions.c (korvattu      */
/*         sillä binäärisellä restart-filella)                               */
/*                                                                           */
/* - TODO: Fotonien cutoff, absorptio, ym. laskurit                          */
/*         addbuf1d.c:n optimointi, fotonien minimixs ja muutenkin noi jutut */
/*         sen inputissa annettavan arvon pitäisi jäädä käyttöön.            */
/*                                                                           */
/* - TODO: Detektorien reaktioihin branchingit isomeerisiin tiloihin.        */
/*         (vaatii vähän muutoksia perusrakenteisiin, toimii nyt palama-     */
/*         laskussa kun bra-data on energiariippuvaa).                       */
/*                                                                           */
/* - Lähdepisteiden tallennuksessa 1/v-painotus vaikuttaa efektiivisyyteen   */
/*   (nopeat systeemit ja detektorit joissa energiaväli rajattu).            */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Known problems and limitations                                            */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* - Optimization mode 1 crashes with segmentation fault with OpenMP.        */
/*   NOTE: Not seen this anymore in a while (12.6.2014 / 2.1.21).            */
/*                                                                           */
/* - Terminal window freezes sometimes and calculation waits for user to     */
/*   press enter (this may be a problem in the terminal application).        */
/*   NOTE: Not seen this anymore in a while (12.6.2014 / 2.1.21).            */
/*                                                                           */
/* - Some MPI implementations (Open MPI) are not thread-safe and may produce */
/*   almost any errors when run in hybrid OpenMP/MPI mode.                   */
/*                                                                           */
/* - Multiplying scattering reactions may be handled different from          */
/*   serpent 1 when calculating the implicit estimate of k-eff. Serpent 2    */
/*   includes all reactions, Serpent 1 only (n,2n)? --> noticeable           */
/*   differences in external source mode with high-energy neutrons.          */
/*                                                                           */
/* - The interpolations in thompsonscattering.c may contain errors.          */
/*                                                                           */
/* - Not compatible with 32-bit systems.                                     */
/*                                                                           */
/* - Soluble absorbers not implemented.                                      */
/*                                                                           */
/* - Analog (n,xn) reactions are disabled because they probably don't work   */
/*   with scattering matrixes.                                               */
/*                                                                           */
/* - Implicit fission disabled (erroneous keff and nsf)                      */
/*                                                                           */
/* - Thermal scattering data cannot be used with multiple isotopes           */
/*                                                                           */
/* - DBRC runs slower compared to Serpent 1 (???)                            */
/*                                                                           */
/* - matlaboutput.c:ssä voi jossain tilateissa olla ääretön luuppi           */
/*   gcu-muuttujan yli. Tämä saa koodin kirjoittamaan kovalevyn täyteen      */
/*   --> suht paha bugi.                                                     */
/*   NOTE: Not seen this anymore in a while (12.6.2014 / 2.1.21).            */
/*                                                                           */
/* - Source file routine is not OpenMP reproducible.                         */
/*                                                                           */
/* - DATA_N_RECORD_TRACKS:n nostaminen ~100000 ja ajo 20 OpenMP threadilla   */
/*   aiheuttaa segmentation faultin muistin varauksessa. Vika on             */
/*   mahdollisesti sama kuin ykkösmoodissa OpenMP:llä ajettaessa.            */
/*   NOTE: Not seen this anymore in a while (12.6.2014 / 2.1.21).            */
/*                                                                           */
/* - Näyttää siltä että toi yllä oleva ongelma liittyy siihen että useampi   */
/*   OpenMP threadi yrittää varata muistia samaan aikaan.                    */
/*   (tää on mahdollisesti korjautunut versiossa 2.1.9)                      */
/*                                                                           */
/* - Multi-physics interface has absolutely no tolerance for missing         */
/*   parameters and similar input errors.                                    */
/*                                                                           */
/* - Joihinkin mesh-plotteihin tulee omituisia mustia alueita                */
/*                                                                           */
/* - Toi tle-juttu pitäisi kattoa uudestaan. printcycleoutput.c printtaa     */
/*   (DT)-flagin perustuen DATA_OPT_USE_DT:hen, eikä tee eroa neutronien ja  */
/*   fotonien välillä. Myös silloin kun kynnysarvo on 0.                     */
/*                                                                           */
/* - Versiossa 2.1.5 oli joku mystinen pointterivika processburnmat.c:ssä    */
/*   (kts. Alexander Auresin meili 5.6.2012). Ongelma on korjaantunut        */
/*   itsestään versiosssa 2.1.6, kun rutiineita on kirjoitettu uusiksi,      */
/*   mutta sen alkuperä ei koskaan selvinnyt.                                */
/*                                                                           */
/* - Version 2.1.6 testilaskuissa oli reilun prosentin eroa nopeimman ryhmän */
/*   kaappausvaikutusaloissa PBMR- ja HTGR-tapauksissa.                      */
/*                                                                           */
/* - usym -optiossa origo ei tee mitään (pitäiskö poistaa?). Pelkkä          */
/*   koordinaattien siirtäminen ei tuotakaan sitä lopputulosta mitä          */
/*   kuviteltiin.                                                            */
/*                                                                           */
/* - Depletion outputin printtaaminen on älytön pullonkaula jos materiaaleja */
/*   on tuhansia --> katso koodin optimointi läpi, ja lisää optio printata   */
/*   koostumukset vain osalle palama-askelista.                              */
/*                                                                           */
/* - Analog lifetime estimators do not work properly with implicit capture.  */
/*                                                                           */
/* - Reaktion arvonnan laskurit ei taida mennä oikein on-the-fly -rutiinin   */
/*   kanssa.                                                                 */
/*                                                                           */
/* - TÄÄ ON TÄRKEÄ: viivästyneet neutronit jätetään nyt lähdemoodissa        */
/*   defaultisti MCNP:n tapaan pois. Tämä pitää ottaa huomioon sitten kun    */
/*   nsf lasketaan implisiittisesti.                                         */
/*                                                                           */
/* - Palama-askeleiden laskuriin tulee jostain yksi ylimääräinen askel       */
/*   decay-moodissa. (tää kai korjattiin jossain vaiheessa?)                 */
/*                                                                           */
/* - Edellisen alueen testaus muuttaa sitä miten overlapit tulee käsiteltyä  */
/*   --> ei välttämättä saada samaa tulosta kuin ilman.                      */
/*                                                                           */
/* - DBRC doesn't work when Doppler preprocessor is invoked for 0K data      */
/*   (broadened data is used for rejection sampling?)                        */
/*                                                                           */
/* - Symmetriajutuissa on jossain vaiheessa ollut häikkää MoveST:n kanssa    */
/*   (valittaa overlapista).                                                 */
/*                                                                           */
/* - Jos OTF sämplää energian alle vaikutusaladatan alarajan, MicroXS()      */
/*   laittaa sen nollaksi. Parempi tapa olisi käyttää katkaisua ja laittaa   */
/*   MicroXS() antamaan errori jos GridFactor() ei saa indeksiä.             */
/*                                                                           */
/* - Interface output does not work with universe symmetries.                */
/*                                                                           */
/* - TFB:ssä voi olla että samaa pintaa säädetään kahdesti (in ja out        */
/*   -pointterit yhteen ja samaan pintaan).                                  */
/*                                                                           */
/* - Mikroskooppinen kokonaisabsorptiovaikutusala ei ehkä ole oikein (antoi  */
/*   xenon-laskussa käytettynä vääriä tuloksia). Sitä käytetään nyt vain ja  */
/*   ainoastaan implisiittisen kaappauksen kanssa, mitä ei oletestattu       */
/*   vähän aikaan (25.1.2013).                                               */
/*                                                                           */
/* - Universumin levelin testaus zonecount.c:ssä käyttää nyt Warn():ia.      */
/*   Muuta toi myöhemmin Error():ksi.                                        */
/*                                                                           */
/* - NUCLIDE_PTR_SUM_ABSXS ei ota huomioon ures-sämpläystä (pitäisi          */
/*   vaikuttaa ainakin implicit capture -moodissa)                           */
/*                                                                           */
/* - Kaappausreatkioista isomeerisille tiloille otetaan vain yksi tila       */
/*   huomioon.                                                               */
/*                                                                           */
/* - Small differences in the error estimates of IFP time constants in       */
/*   OpenMP parallel mode (mean values consistent)                           */
/*                                                                           */
/* - Variable length argument lists may not work with all compilers          */
/*   (problems with warn.c in cycgwin, see posts 4.2.2014, titled            */
/*   "Serpent2.1.16 stops after giving the message "Warning ..")             */
/*                                                                           */
/* - Noi muut ajomoodit "-plot", "-disperse", ym. voi aiheuttaa ongelmia     */
/*   MPI:n kanssa.                                                           */
/*                                                                           */
/* - Se DATA_FIXED_BLOCK_SIZE:n allokoiminen PRIVA- ja RES-taulukoille       */
/*   kasvattaa käyttämättömän muistin kokoa aika merkittävästi kun           */
/*   OMP taskeja on paljon. (koko homman idea on että VALID_PTR:iä) voi      */
/*   käyttää pointtereiden testaukseen. Tämän voisi katsoa läpi ja           */
/*   korjailla.                                                              */
/*                                                                           */
/* - Ton disperse2.c:n voisi poistaa kokonaan                                */
/*                                                                           */
/* - LE-algoritmi ekstrapoloi Xe-135 konsentraation pielen jos alussa ei     */
/*   käytetä riittävän lyhyitä askelia                                       */
/*                                                                           */
/* - Jotkut listarutiinit ei toimi enää sen jälkeen kun listaan osoittava    */
/*   pointteri on kopioitu uuteen osoitteeseen RDB/WDB -arrayssa (esim.      */
/*   sorttaus). Tämä siksi että rakenteessa piilossa oleva root-pointteri    */
/*   osoittaa edelleen vanhaan paikkaan. Ei varsinainen ongelma, mutta hyvä  */
/*   pitää mielessä.                                                         */
/*                                                                           */
/* - Cell source ei toimi STL solidien kanssa (kts. kommentti                */
/*   processstlgeometry.c:n alussa).                                         */
/*                                                                           */
/* - Outo ongelma trackmode.c:ssä kun nps on pieni (trackmode_150609)        */
/*                                                                           */
/* - Transmutaatioketjuihin linkitetään S(a,b) -nuklideja jos niillä on      */
/*   sama ID kuin moderaattorissa (esim. polttoaine 06c ja vesi 06c -->      */
/*   1001.06s tulee polttoaineen koostumukseen). Jos polttoaineen alku-      */
/*   peräisessä koostumuksessa on vielä 1001.06c, niin burnmatcompositions.c */
/*   antaa errorin:                                                          */
/*                                                                           */
/*   http://ttuki.vtt.fi/serpent/viewtopic.php?f=25&t=2084&sid=a6028bba3f161239f4e9793b803003d8                                                              */
/*                                                                           */
/*   Muussa tapauksessa polttoaineen vedyllä on veden S(a,b)-kirjasto. Tämä  */
/*   ongelma on aika hankala korjata, sillä se liittyy päivityksessä 2.1.17  */
/*   tehtyyn muutokseen jolla S(a,b)-datan käyttö sallitaan myös palaville   */
/*   materiaaleille. Ketjut pitäisi siis muodostaa S(a,b)-nuklidiin siinä    */
/*   tapauksessa että sellainen on alkuperäisessä koostumuksessa mukana,     */
/*   muussa tapauksessa nuklidiin jolla dataa ei ole.                        */
/*                                                                           */
/* - Cell pointterit linkitetään detektoreihin ennen kuin nestit on          */
/*   prosessoitu --> nest cellejä ei voi käyttää detektorien kanssa          */
/*   (Serpent 1:ssä toimii)                                                  */
/*                                                                           */
/* - Detektorien energiagrideissä binin rajaenergialle osuva piste menee     */
/*   eri puolelle kuin MCNP:llä. (tästä kommentti manuaaliin)                */
/*                                                                           */
/* - Negatiiviset vaikutusalat käsitellään varmaan eri tavalla kuin MCNP:ssä */
/*   (Serpentissä nollataan). Tällä voi myös olla vaikutusta kokonais-       */
/*   vaikutusalaan (säilytetäänkö ACE-datan kokonaisvaikutusala vai          */
/*   elastinen sironta). Esim. JEFF3.2 -kirjaston 22046 eroja spektrissä.    */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* TODO - list and notes to self                                             */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/* - 3D pin structure                                                        */
/*                                                                           */
/* - Outputtiin printattavien muuttujien nimet suoraan structuresta ja       */
/*   printvalues.c:n uudelleenkirjoitus.                                     */
/*                                                                           */
/* - Note -funktiosta joku järkevä ja systemaattinen viritys                 */
/*                                                                           */
/* - Katso läpi palamanuklidien lataaminen ja lisää aktinidirajat (tästä oli */
/*   jo foorumilla kysymys)                                                  */
/*                                                                           */
/* - materialtotals.c:n rinnakkaistus (for-luuppi) ei ehkä ole optimaalinen. */
/*                                                                           */
/* - calculatetransmuxs.c:n spektrien summa pitää tehdä jotenkin fiksummin   */
/*   kuin mitä se nyt on tehty. Ilman B1-vuotokorjausta summa otetaan        */
/*   scoretransmuxs.c:ssä laskettavasta arvosta, vuotokorjauksen kanssa      */
/*   summana spektrin yli. Tämä ei toimi ures-taulukoiden kanssa.            */
/*                                                                           */
/* - Palama-askelien tarkistus (kumulatiiviset vs. absoluuttiset)            */
/*                                                                           */
/* - Albedoreunaehtojen iterointi 3D (aksiaalisesti äärellinen) tapauksissa? */
/*                                                                           */
/* - Lisää varoitukset jos MC volume calculation rutiini antaa liian isoja   */
/*   tilastollisia virheitä.                                                 */
/*                                                                           */
/* - Poista ABS_KEFF ja ABS_KINF kun ne ei oikeasti ole absortpio-           */
/*   estimaattoreita.                                                        */
/*                                                                           */
/* - Prosessointirutiineita ei tarvitsisi toistaa palamalaskussa muille kuin */
/*   poltettaville materiaaleille.                                           */
/*                                                                           */
/* - Muistin loppuminen ei aina ilmoittele itsestään --> korjaa. Se voisi    */
/*   antaa myös ideoita siitä mihin muisti hukkuu, ja miten kulutusta voisi  */
/*   pienentää.                                                              */
/*                                                                           */
/* - Reprosessointirutiineihin optio korvata materiaalin koko nuklidivektori */
/*   toisella. (Alexander Auresin full-core -ongelma)                        */
/*                                                                           */
/* - Testaa voiko k-moodin skaalautuvuutta parantaa simuloimalla useampi     */
/*   sukupolvi samassa bätsissä? (onko tällä jotain muita seuraamuksia?)     */
/*                                                                           */
/* - Toi calculatemacroxs.c on jostain syystä tosi hidas OpenMP-moodissa     */
/*   (voi olla että siellä on joku DEBUG-tarkastus)                          */
/*                                                                           */
/* - Lähdemoodin MPI-rinnakkaistus tehdään nyt aivan tarpeettoman            */
/*   monimutkaisesti (samalla tavalla kuin kriittisyysmoodissa)              */
/*                                                                           */
/* - TFB-moodissa pitäisi olla joku erillinen skip cycle -viritys external   */
/*   source moodia varten (nyt ensimmäinen sykli hypätään yli)               */
/*                                                                           */
/* - Uusien boundary condition -rutiinien myötä pin-cell -tyyppinen lasku    */
/*   on todella hidas. Tuohon voisi miettiä sellaista optiota että neutronin */
/*   pysäyttäminen ulkoreunalle tehdään vain silloin jos se on esim. virta-  */
/*   detektorin tai aikavakioiden laskemisen kannalta välttämätöntä.         */
/*                                                                           */
/* - Geneerinen koordinaatistomuunnosfunktio olis näppärä ja voisi korvata   */
/*   esim. PolarAngle():n (Cart <---> cyl <---> sph).                        */
/*                                                                           */
/* - Disperser-modulin uudelleenkirjoitus siten että se käyttää Serpentin    */
/*   varsinaista geometriarutiinia.                                          */
/*                                                                           */
/* - Kirjastojen directory filejen uudelleenprosessointi uudella skriptillä  */
/*   (HUOM: TENDL-kirjastossa ei ole lainkaan asetettu isomeerisia tiloja).  */
/*                                                                           */
/* - Tee loppuun se fillien pistejuttu                                       */
/*                                                                           */
/* - materiaalirakenteessa voisi esim myrkkyjen statistiikkaa yhdistää       */
/*                                                                           */
/* - Lämpötila- ja tiheysjakaumien välittäminen voisi selkeytyä jos sisäiset */
/*   ratkaisijat käyttäisivät samoja rajapintoja ulkoisten kanssa.           */
/*   Lämpötilajakaumaan pitää saada koordinaatit funktiona jollain tavalla   */
/*   mukaan, sillä esim. liittovuodetektori tarvitsee arvot muualla kuin     */
/*   edellisessä törmäyspisteessä. Makroskooppinen vaikutusala voisi         */
/*   periaatteessa riippua paikasta.                                         */
/*                                                                           */
/* - Noita input error tarkistuksia saisi järkevimmiksi jos parametridatan   */
/*   kopioisi structeihin samalla tavalla kuin nfg:ssä on nyt tehty          */
/*                                                                           */
/* - Paikallisten koordinaattien tallennukseen on nyt 2 päällekkäistä        */
/*   järjestelmää (universumi ja level). Selvitä tarvitaanko noita molempia. */
/*                                                                           */
/* - Materiaalidetektorien automaattinen jako palama-aluebineihin.           */
/*                                                                           */
/* - Värikoodit geometria ja mesh-plotteihin.                                */
/*                                                                           */
/* - Log-log -interpolaatio ures-datalle !!!                                 */
/*                                                                           */
/* - 6-factor formula.                                                       */
/*                                                                           */
/* - Burnable mixtures                                                       */
/*                                                                           */
/* - CalculateMasses() voisi tarkistaa normalisoinnin ja antaa errorin jos   */
/*   yritetään normeerata tehotiheyteen tms. ja massa on nolla. (normeeraus- */
/*   kerroin menee nyt kai tuossa tapauksessa aina nollaksi.)                */
/*                                                                           */
/* - Tee tosta private data ym. hommasta sellanen että sitä muistia ei       */
/*   jaeta kuin vasta sitten kun kaikki varaukset on tehty --> pitäisi       */
/*   poistaa tarpeen kikkailla noiden preallocmem-juttujen kanssa.           */
/*                                                                           */
/* - Korjaa se bugi joka antaa nollatiheydet mikstureille jos ne lueataan    */
/*   väärässä järjestyksessä.                                                */
/*                                                                           */
/* - Free-gas thresholdi input-optioksi                                      */
/*                                                                           */
/* - UMSH- ja CGNS-rakenteissa on hirveästi päällekkäisyyttä --> koita       */
/*   yhdistää.                                                               */
/*                                                                           */
/* - Tarkista onko ADF:ien mikroryhmälaskuun mitään järkevää syytä, ja muuta */
/*   rutiini yksivaiheiseksi (periaatteessa on, jos esim. virroilla halutaan */
/*   tehdä jotain moniryhmämuodossa)                                         */
/*                                                                           */
/* - EXTRAP_L = 1E-6 voi olla ylikonservatiivinen --> kokeile 1E-9           */
/*                                                                           */
/* - Komentorivioptioksi geometria- ja materiaalidatan printtaus käyttäjän   */
/*   antamassa pisteessä (geometryerror.c:tä voi käyttää pohjana)            */
/*                                                                           */
/* - Versioon 2.1.22 implementoidun printtausrutiinin käyttö                 */
/*   matlaboutput.c:ssä.                                                     */
/*                                                                           */
/* - Cosine binning for detectors (?)                                        */
/*                                                                           */
/* - Selkeytä makeenergygrid.c ja gridsearch.c -juttuja                      */
/*                                                                           */
/* - Kaikki mahdolliset S(a,b) datat uusiin kirjastoihin (kriittisyys-       */
/*   kokeissa ym. käytetään muoveja jne.)                                    */
/*                                                                           */
/* - Toi uniongridihomma säästäisi muistia jos siirtyisi useamman gridin     */
/*   systeemiin siten että jakaisi nuklidit energiapistemäärän mukaan eri    */
/*   grideihin. Tämä edellyttäisi sitä että makrovaikutusalat saataisiin     */
/*   summaamalla muutaman arvon yli. Ei pitäisi hidastaa, mutta voi olla     */
/*   hankala toteuttaa. Ehkä sitten jos noita rutiineja tarkistetaan ennen   */
/*   lopullista jakelua.                                                     */
/*                                                                           */
/* - URES-alueen palamakäsittelyssä voisi olla jotain optimoitavaa.          */
/*                                                                           */
/* - long --> double type casting vie jonkin verran CPU-aikaa. Sama ei päde  */
/*   double --> long:iin.                                                    */
/*                                                                           */
/* - Erillinen div-kortin subx, suby, subz -optiolla jaettujen alueiden      */
/*   käsittely volumesmc.c:hen.                                              */
/*                                                                           */
/* - Coef-laskun ensimmäisen transport-syklin laskenta-ajan arviointi bugaa. */
/*                                                                           */
/*****************************************************************************/

/*****************************************************************************/
/*                                                                           */
/* Missing group constant, etc.                                              */
/*                                                                           */
/* - Percursor group-wise delayed neutron spektra                            */
/*                                                                           */
/* - Restart-rutiinin voisi jossain vaiheessa kirjoittaa uudestaan niin että */
/*   materiaalikoostumukset luodaan kokonaan uudestaan ja konsentraatiolle   */
/*   käytetään jotain sopivaa katkaisua.                                     */
/*                                                                           */
/* - Microscopic group constants based on a user-defined nuclide list        */
/*   (sirontamatriisien laskemista varten pitää varmaan tehdä uusi rutiini   */
/*    joka sämplää reaktiota ja laskee niistä vastaavat todennäköisyydet)    */
/*                                                                           */
/*****************************************************************************/
